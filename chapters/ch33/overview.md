# Chapter 33: λ‹¤μ‹ λ§λ‚ μ€ν - κ²°ν•© μ¶©λ ν•΄μ†

## κ°μ” (Overview)
μ΄λ² μ±•ν„°μ—μ„λ” Pandasλ¥Ό μ‚¬μ©ν•μ—¬ μ—¬λ¬ λ°μ΄ν„°μ…‹μ„ κ²°ν•©ν•  λ• λ°μƒν•λ” 'κ²°ν•© μ¶©λ(Join Conflicts)'μ„ μ§€νλ΅­κ² ν•΄μ†ν•λ” μ „λµμ„ λ°°μ›λ‹λ‹¤. `merge()` λ©”μ„λ“μ `indicator` νλΌλ―Έν„°λ¥Ό μ΄μ©ν• κ²°ν•© μ¶μ² ν™•μΈ, `validate` νλΌλ―Έν„°λ¥Ό μ΄μ©ν• κ²°ν•© μ ν¨μ„± κ²€μ‚¬, κ·Έλ¦¬κ³  `suffixes` νλΌλ―Έν„°λ¥Ό μ΄μ©ν• μ»¬λΌ μ΄λ¦„ μ¶©λ ν•΄κ²°κ³Ό κ°™μ€ κΈ°μ μ„ νƒκµ¬ν•©λ‹λ‹¤. μ¶μ• κµ½κΈ° 33μ¥μ λ‹¤μ‹ λ§λ‚ μ€νμ™€ μ”ν•λ³µμ 21μ¥μ λ² λ“λ΅μ νλ³µ λ§μ”€μ„ ν†µν•΄, λ°μ΄ν„°μ λ¬΄κ²°μ„±μ„ μ μ§€ν•κ³  μ •ν™•ν• λ¶„μ„ κ²°κ³Όλ¥Ό μ–»λ” μ§€νλ¥Ό λ°μ΄ν„°μ μΌλ΅ μ΄ν•΄ν•κ³  λ¬µμƒν•©λ‹λ‹¤.

This chapter introduces strategies for wisely resolving 'join conflicts' that arise when combining multiple datasets using Pandas. We will explore techniques such as checking join sources using the `indicator` parameter of the `merge()` method, validating joins using the `validate` parameter, and resolving column name conflicts using the `suffixes` parameter. Through the grace reunited in Exodus 33 and Peter's restoration in John 21, we will understand and meditate on the wisdom of maintaining data integrity and obtaining accurate analytical results.

---

## π“ μ„±κ²½ λ³Έλ¬Έ κΉμ΄ λ¬µμƒ

### μ¶μ• κµ½κΈ° 33μ¥: λ‹¤μ‹ λ§λ‚ μ€ν

κΈμ†΅μ•„μ§€ μ‚¬κ±΄ μ΄ν›„ ν•λ‚λ‹κ»μ„λ” μ΄μ¤λΌμ— λ°±μ„±κ³Ό ν•¨κ» κ°€μ§€ μ•κ² λ‹¤κ³  λ§μ”€ν•μ‹λ©° μ§„λ…Έν•μ…¨μµλ‹λ‹¤. κ·Έλ¬λ‚ λ¨μ„Έμ κ°„μ ν• μ¤‘λ³΄λ΅ ν•λ‚λ‹κ»μ„λ” λ‹¤μ‹ λ§μμ„ λμ΄ν‚¤μ‹κ³  "λ‚΄κ°€ μΉν κ°€λ¦¬λΌ λ‚΄κ°€ λ„λ¥Ό μ•μ„ν•λ¦¬λΌ"κ³  μ•½μ†ν•μ…¨μµλ‹λ‹¤. μ΄λ” κΉ¨μ–΄μ§„ κ΄€κ³„κ°€ νλ³µλκ³ , λ‹¤μ‹ ν•λ‚λ‹μ μ€νλ¥Ό μ…κ² λ κ°κ²©μ μΈ μκ°„μ…λ‹λ‹¤. λ°μ΄ν„° λ¶„μ„μ—μ„λ„ μ—¬λ¬ λ°μ΄ν„°μ…‹μ„ κ²°ν•©ν•  λ• λ°μƒν•λ” μ¶©λμ„ ν•΄μ†ν•κ³  λ°μ΄ν„°μ λ¬΄κ²°μ„±μ„ νλ³µν•λ” κ²ƒμ€ μ΄μ™€ μ μ‚¬ν•©λ‹λ‹¤.

- **κΉ¨μ–΄μ§„ κ΄€κ³„:** κΈμ†΅μ•„μ§€ μ‚¬κ±΄μΌλ΅ μΈν• ν•λ‚λ‹μ μ§„λ…Έ (μ¶ 32:7-10)
- **λ¨μ„Έμ μ¤‘λ³΄:** ν•λ‚λ‹μ λ§μμ„ λμ΄ν‚΄ (μ¶ 32:11-14, 33:12-17)
- **λ‹¤μ‹ λ§λ‚ μ€ν:** ν•λ‚λ‹κ»μ„ μΉν ν•¨κ» κ°€μ‹κ² λ‹¤κ³  μ•½μ† (μ¶ 33:14)

μ΄ λ³Έλ¬Έμ€ λ°μ΄ν„° κ²°ν•© μ¶©λ ν•΄μ†μ— μκ°μ„ μ¤λ‹λ‹¤. μ—¬λ¬ λ°μ΄ν„°μ…‹μ„ κ²°ν•©ν•  λ• λ°μƒν•λ” κ²°ν•© μ¶©λμ€ κΉ¨μ–΄μ§„ κ΄€κ³„μ²λΌ λ°μ΄ν„°μ λ¬΄κ²°μ„±μ„ ν›Όμ†ν•  μ μμµλ‹λ‹¤. `merge()` λ©”μ„λ“μ `indicator` νλΌλ―Έν„°λ” κ²°ν•©λ λ°μ΄ν„°μ μ¶μ²λ¥Ό λ…ν™•ν ν•μ—¬ μ¶©λμ μ›μΈμ„ νμ•…ν•λ” λ° λ„μ›€μ„ μ¤λ‹λ‹¤. `validate` νλΌλ―Έν„°λ” κ²°ν•©μ μ ν¨μ„±μ„ κ²€μ‚¬ν•μ—¬ μλ»λ κ²°ν•©μ„ λ°©μ§€ν•κ³ , `suffixes` νλΌλ―Έν„°λ” μ»¬λΌ μ΄λ¦„ μ¶©λμ„ ν•΄κ²°ν•μ—¬ λ°μ΄ν„°μ λ¬΄κ²°μ„±μ„ μ μ§€ν•©λ‹λ‹¤. μ΄λ” λ°μ΄ν„°μ μ‹ λΆ°μ„±μ„ νλ³µν•λ” λ° ν•„μμ μ…λ‹λ‹¤.

### μ”ν•λ³µμ 21:15-19: λ² λ“λ΅μ νλ³µ

μμλ‹κ»μ„ λ¶€ν™ν•μ‹  ν›„ λ””λ² λ΄ λ°”λ‹·κ°€μ—μ„ λ² λ“λ΅λ¥Ό μ°Ύμ•„κ°€ "μ”ν•μ μ•„λ“¤ μ‹λ¬μ•„ λ„¤κ°€ λ‚λ¥Ό μ‚¬λ‘ν•λλƒ"κ³  μ„Έ λ² λ¬ΌμΌμ…¨μµλ‹λ‹¤. λ² λ“λ΅λ” μμλ‹μ„ μ„Έ λ² λ¶€μΈν–λ κ³Όκ±°κ°€ μμ—μ§€λ§, μμλ‹μ€ κ·Έλ¥Ό λ‹¤μ‹ νλ³µμ‹ν‚¤μ‹κ³  μ–‘μ„ λ¨Ήμ΄λΌκ³  μ‚¬λ…μ„ μ¬ν™•μΈμ‹μΌ μ£Όμ…¨μµλ‹λ‹¤. μ΄λ” κΉ¨μ–΄μ§„ κ΄€κ³„κ°€ νλ³µλκ³ , λ‹¤μ‹ μ‚¬λ…μ„ λ¶€μ—¬λ°›λ” μ€νμ μκ°„μ…λ‹λ‹¤.

- **μ„Έ λ²μ μ§λ¬Έ:** λ² λ“λ΅μ μ„Έ λ² λ¶€μΈμ„ μƒκΈ°μ‹ν‚΄
- **μ‚¬λ‘μ ν™•μΈ:** λ„¤κ°€ λ‚λ¥Ό μ‚¬λ‘ν•λλƒ
- **μ‚¬λ… μ¬ν™•μΈ:** λ‚΄ μ–‘μ„ λ¨Ήμ΄λΌ

μ΄ λ§μ”€μ€ λ°μ΄ν„° κ²°ν•© μ¶©λ ν•΄μ†μ λ©μ μ— μκ°μ„ μ¤λ‹λ‹¤. μ—¬λ¬ λ°μ΄ν„°μ…‹μ„ κ²°ν•©ν•  λ• λ°μƒν•λ” μ¶©λμ€ λ² λ“λ΅μ λ¶€μΈμ²λΌ λ°μ΄ν„°μ λ¶μΌμΉλ¥Ό μ•ΌκΈ°ν•  μ μμµλ‹λ‹¤. `merge()`μ `indicator`μ™€ `validate` νλΌλ―Έν„°λ” λ°μ΄ν„° κ²°ν•©μ μ ν¨μ„±μ„ κ²€μ‚¬ν•μ—¬ μλ»λ κ²°ν•©μ„ λ°©μ§€ν•κ³ , `suffixes` νλΌλ―Έν„°λ” μ»¬λΌ μ΄λ¦„ μ¶©λμ„ ν•΄κ²°ν•μ—¬ λ°μ΄ν„°μ λ¬΄κ²°μ„±μ„ μ μ§€ν•©λ‹λ‹¤. μ΄λ” λ°μ΄ν„°μ μ‹ λΆ°μ„±μ„ νλ³µν•κ³ , μ •ν™•ν• λ¶„μ„ κ²°κ³Όλ¥Ό μ–»λ” λ° ν•„μμ μ…λ‹λ‹¤. μμλ‹κ»μ„ λ² λ“λ΅λ¥Ό νλ³µμ‹ν‚¤μ‹  κ²ƒμ²λΌ, λ°μ΄ν„° λ¶„μ„μ—μ„λ„ μ¤λ¥λ¥Ό μμ •ν•κ³  μ§„μ‹¤μ„ λ“λ¬λ‚΄λ” κ²ƒμ΄ μ¤‘μ”ν•©λ‹λ‹¤.

---

## π” μ¨κ²¨μ§„ μ§λ¬Έ λ°κ²¬

**μ¶μ• κµ½κΈ°μ—μ„ λ°κ²¬ν•  μ§λ¬Έλ“¤:**

- μ΄μ¤λΌμ— λ°±μ„±μ μμΆ… λ°μ΄ν„°μ™€ ν•λ‚λ‹μ μ‘λ‹µ λ°μ΄ν„°λ¥Ό `merge()`λ΅ κ²°ν•©ν•  λ•, `indicator` νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•μ—¬ κ²°ν•© μ¶μ²λ¥Ό ν™•μΈν•λ©΄, μ–΄λ–¤ μ‹μ μ— λ°μ΄ν„° λ¶μΌμΉ(μ¶©λ)κ°€ λ°μƒν–μ„κΉ?
- κΈμ†΅μ•„μ§€ μ‚¬κ±΄ μ „ν›„μ μ΄μ¤λΌμ— λ°±μ„± λ°μ΄ν„°λ¥Ό `merge()`λ΅ κ²°ν•©ν•  λ•, `validate` νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•μ—¬ κ²°ν•© μ ν¨μ„±μ„ κ²€μ‚¬ν•λ©΄, μ–΄λ–¤ μ ν•μ κ²°ν•© μ¶©λ(μ: 1λ€1, 1λ€λ‹¤)μ΄ λ°μƒν–μ„κΉ?
- λ¨μ„Έμ μ¤‘λ³΄ λ°μ΄ν„°μ™€ ν•λ‚λ‹μ μ‘λ‹µ λ°μ΄ν„°λ¥Ό `merge()`λ΅ κ²°ν•©ν•  λ•, μ»¬λΌ μ΄λ¦„ μ¶©λμ΄ λ°μƒν•λ©΄ `suffixes` νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•μ—¬ μ–΄λ–»κ² ν•΄κ²°ν•  μ μμ„κΉ?

**μ”ν•λ³µμμ—μ„ λ°κ²¬ν•  μ§λ¬Έλ“¤:**

- λ² λ“λ΅μ λ―Ώμ μƒνƒ λ°μ΄ν„°μ™€ μμλ‹μ μ§λ¬Έ λ°μ΄ν„°λ¥Ό `merge()`λ΅ κ²°ν•©ν•  λ•, `indicator` νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•μ—¬ κ²°ν•© μ¶μ²λ¥Ό ν™•μΈν•λ©΄, μ–΄λ–¤ μ‹μ μ— λ² λ“λ΅μ λ―Ώμμ΄ ν”λ“¤λ Έμ„κΉ?
- μ μλ“¤μ μ‚¬λ… λ°μ΄ν„°μ™€ μμλ‹μ κ°€λ¥΄μΉ¨ λ°μ΄ν„°λ¥Ό `merge()`λ΅ κ²°ν•©ν•  λ•, `validate` νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•μ—¬ κ²°ν•© μ ν¨μ„±μ„ κ²€μ‚¬ν•λ©΄, μ–΄λ–¤ μ ν•μ κ²°ν•© μ¶©λμ΄ λ°μƒν–μ„κΉ?
- μμλ‹μ μ‚¬λ‘ λ°μ΄ν„°μ™€ λ² λ“λ΅μ μ‚¬λ‘ κ³ λ°± λ°μ΄ν„°λ¥Ό `merge()`λ΅ κ²°ν•©ν•  λ•, μ»¬λΌ μ΄λ¦„ μ¶©λμ΄ λ°μƒν•λ©΄ `suffixes` νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•μ—¬ μ–΄λ–»κ² ν•΄κ²°ν•  μ μμ„κΉ?

μ΄λ° μ§λ¬Έλ“¤μ€ λ°μ΄ν„°μ 'κ²°ν•© μ¶©λ ν•΄μ†'λΌλ” κ΄€μ μΌλ΅ μ„±κ²½ λ³Έλ¬Έμ„ λ” κΉμ΄ μ΄ν•΄ν•λ” λ° λ„μ›€μ„ μ¤„ κ²ƒμ΄λ‹¤.

---

## π“ νλ‹¤μ¤λ΅ μ„±κ²½ νƒκµ¬ν•κΈ°

### νƒκµ¬ 1: λ‹¤μ‹ λ§λ‚ μ€ν λ°μ΄ν„° κ²°ν•© μ¶μ² ν™•μΈ (merge indicator)

```python
import pandas as pd
import numpy as np
from chapters.ch33.grace_data import GraceDataGenerator
from chapters.ch33.merge_indicator_resolver import MergeIndicatorResolver

# μ€ν λ°μ΄ν„° μƒμ„±
data_gen = GraceDataGenerator()
df_grace1, df_grace2 = data_gen.generate_grace_data()

print("π™ μ€ν λ°μ΄ν„°μ…‹ 1 μ”μ•½:\n", df_grace1.head())
print("\nπ™ μ€ν λ°μ΄ν„°μ…‹ 2 μ”μ•½:\n", df_grace2.head())

# `merge()`μ `indicator` νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•μ—¬ κ²°ν•© μ¶μ² ν™•μΈ
resolver = MergeIndicatorResolver(df_grace1, df_grace2)
merged_df_indicator = resolver.resolve_with_indicator(on='id', how='outer')

print("\n--- `indicator` νλΌλ―Έν„°λ΅ κ²°ν•© μ¶μ² ν™•μΈ ν›„ ---")
print(merged_df_indicator)
print(merged_df_indicator['_merge'].value_counts())
```

### νƒκµ¬ 2: λ² λ“λ΅μ νλ³µ λ°μ΄ν„° κ²°ν•© μ ν¨μ„± κ²€μ‚¬ λ° μ»¬λΌ μ¶©λ ν•΄κ²° (validate, suffixes)

```python
import pandas as pd
import numpy as np
from chapters.ch33.grace_data import GraceDataGenerator # λ™μΌ λ°μ΄ν„° μƒμ„±κΈ° μ‚¬μ©
from chapters.ch33.merge_validator import MergeValidator
from chapters.ch33.column_conflict_resolver import ColumnConflictResolver

# λ² λ“λ΅μ νλ³µ λ°μ΄ν„° μƒμ„± (κ°€μ •)
data_gen = GraceDataGenerator()
df_peter1, df_peter2 = data_gen.generate_grace_data()

# `validate` νλΌλ―Έν„°λ¥Ό μ΄μ©ν• κ²°ν•© μ ν¨μ„± κ²€μ‚¬ (μ: 1λ€1 κ²°ν•©)
validator = MergeValidator(df_peter1, df_peter2)
merged_df_validated = validator.validate_merge(on='id', how='inner', validate='one_to_one')

print("\n--- `validate` νλΌλ―Έν„°λ΅ κ²°ν•© μ ν¨μ„± κ²€μ‚¬ ν›„ ---")
print(merged_df_validated.head())

# μ»¬λΌ μ΄λ¦„ μ¶©λ ν•΄κ²° (suffixes)
df_peter1_conflict = df_peter1.rename(columns={'value': 'score'})
df_peter2_conflict = df_peter2.rename(columns={'value': 'score'})

resolver = ColumnConflictResolver(df_peter1_conflict, df_peter2_conflict)
merged_df_suffixes = resolver.resolve_column_conflicts(on='id', how='inner', suffixes=['_left', '_right'])

print("\n--- `suffixes` νλΌλ―Έν„°λ΅ μ»¬λΌ μ΄λ¦„ μ¶©λ ν•΄κ²° ν›„ ---")
print(merged_df_suffixes.head())
```

---

## β­ λ†€λΌμ΄ λ°κ²¬λ“¤

### λ°κ²¬ 1: `indicator` νλΌλ―Έν„°λ΅ λ‹¤μ‹ λ§λ‚ μ€νμ μ¶μ² ν™•μΈ

`merge()` λ©”μ„λ“μ `indicator` νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•λ©΄ κ²°ν•©λ λ°μ΄ν„°μ κ° ν–‰μ΄ μ–΄λ λ°μ΄ν„°μ…‹μ—μ„ μ™”λ”μ§€(`left_only`, `right_only`, `both`) λ…ν™•ν•κ² ν™•μΈν•  μ μμµλ‹λ‹¤. μ΄λ” κΈμ†΅μ•„μ§€ μ‚¬κ±΄ μ΄ν›„ ν•λ‚λ‹κ»μ„ λ‹¤μ‹ μ΄μ¤λΌμ— λ°±μ„±κ³Ό ν•¨κ» κ°€μ‹κ² λ‹¤κ³  μ•½μ†ν•μ‹  μ€νμ μ¶μ²λ¥Ό ν™•μΈν•λ” κ²ƒκ³Ό κ°™μµλ‹λ‹¤. λ°μ΄ν„° λ¶μΌμΉμ μ›μΈμ„ νμ•…ν•κ³  λ°μ΄ν„°μ λ¬΄κ²°μ„±μ„ νλ³µν•λ” λ° ν•„μμ μ…λ‹λ‹¤.

### λ°κ²¬ 2: `validate` νλΌλ―Έν„°λ΅ λ² λ“λ΅μ νλ³µμ²λΌ κ²°ν•© μ ν¨μ„± κ²€μ‚¬

`validate` νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•μ—¬ λ°μ΄ν„° κ²°ν•©μ μ ν¨μ„±(μ: 1λ€1, 1λ€λ‹¤)μ„ κ²€μ‚¬ν•λ” κ²ƒμ€ λ² λ“λ΅κ°€ μμλ‹μ„ μ„Έ λ² λ¶€μΈν• ν›„ λ‹¤μ‹ μ‚¬λ‘μ„ κ³ λ°±ν•λ©° νλ³µλ κ²ƒμ²λΌ, κΉ¨μ–΄μ§„ κ΄€κ³„λ¥Ό νλ³µν•κ³  λ°μ΄ν„°μ μ •ν™•μ„±μ„ ν™•λ³΄ν•λ” κ²ƒκ³Ό κ°™μµλ‹λ‹¤. μλ»λ κ²°ν•©μ„ μ‚¬μ „μ— λ°©μ§€ν•μ—¬ λ°μ΄ν„°μ μ‹ λΆ°μ„±μ„ μ μ§€ν•λ” λ° ν•„μμ μ…λ‹λ‹¤.

### λ°κ²¬ 3: `suffixes` νλΌλ―Έν„°λ” μ»¬λΌ μ΄λ¦„ μ¶©λ ν•΄μ†μ μ§€ν

`suffixes` νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•μ—¬ μ»¬λΌ μ΄λ¦„ μ¶©λμ„ ν•΄κ²°ν•λ” κ²ƒμ€ μ—¬λ¬ κ΄€μ μ λ°μ΄ν„°λ¥Ό ν†µν•©ν•  λ• λ°μƒν•λ” νΌλ€μ„ μ§€νλ΅­κ² ν•΄μ†ν•λ” κ²ƒκ³Ό κ°™μµλ‹λ‹¤. μ΄λ” λ°μ΄ν„°μ μλ―Έλ¥Ό λ…ν™•ν ν•κ³ , λ¶„μ„ κ²°κ³Όμ μ¤ν•΄λ¥Ό λ°©μ§€ν•μ—¬ λ°μ΄ν„°μ λ¬΄κ²°μ„±μ„ μ μ§€ν•λ” λ° κΈ°μ—¬ν•©λ‹λ‹¤. λ§μΉ λ² λ“λ΅κ°€ μμλ‹μ„ λ¶€μΈν–λ κ³Όκ±°μ μ•„ν””μ„ λ”›κ³  μƒλ΅μ΄ μ‚¬λ…μ„ λ°›μ€ κ²ƒμ²λΌ, λ°μ΄ν„°λ„ μ¶©λμ„ ν•΄κ²°ν•κ³  μƒλ΅μ΄ μλ―Έλ¥Ό λ¶€μ—¬λ°›μµλ‹λ‹¤.

---

## π¨ λΈ”λ λ”© λ¨λ“: μ¶μ• κµ½ Γ— μ”ν•λ³µμμ ν†µν•© ν†µμ°°

|μ¶μ• κµ½κΈ° μ§„λ¦¬|μ”ν•λ³µμ μ§„λ¦¬|νλ‹¤μ¤ λ„κµ¬|μμ  λ°κ²¬|
|---|---|---|---|
|κΈμ†΅μ•„μ§€ μ‚¬κ±΄ μ΄ν›„ λ‹¤μ‹ λ§λ‚ μ€ν|λ² λ“λ΅μ νλ³µκ³Ό μ‚¬λ… μ¬ν™•μΈ|`merge(indicator=True)`|κΉ¨μ–΄μ§„ κ΄€κ³„μ νλ³µκ³Ό λ°μ΄ν„° λ¬΄κ²°μ„±|
|ν•λ‚λ‹κ³Όμ μ–Έμ•½ κ°±μ‹ |μμλ‹κ³Όμ μ‚¬λ‘ ν™•μΈ|`merge(validate='one_to_one')`|λ°μ΄ν„° κ²°ν•©μ μ •ν™•μ„±κ³Ό μ‹ λΆ°μ„±|
|λ¨μ„Έμ μ¤‘λ³΄μ™€ ν•λ‚λ‹μ μ•½μ†|λ‚΄ μ–‘μ„ λ¨Ήμ΄λΌ = μƒλ΅μ΄ μ‚¬λ…|`merge(suffixes)`|μ»¬λΌ μ΄λ¦„ μ¶©λ ν•΄κ²°κ³Ό λ°μ΄ν„°μ μλ―Έ λ…ν™•ν™”|
|λ°μ΄ν„°μ λ¬΄κ²°μ„± μ μ§€|μμ  μμμ„± μ μ§€|κ²°ν•© μ¶©λ ν•΄μ† μ „λµ|λ°μ΄ν„°μ μ‹ λΆ°μ„± ν™•λ³΄μ™€ μμ  μ„±μ™|
|μ •ν™•ν• λ¶„μ„ κ²°κ³Ό|ν•λ‚λ‹μ λ»κ³Ό μ„­λ¦¬ λ°κ²¬|λ°μ΄ν„° κ²°ν•©|μμ  ν†µμ°°κ³Ό μ§€νλ΅μ΄ μμ‚¬κ²°μ •|

> **π’ λΈ”λ λ”© κ²°κ³Ό**: `merge()` λ©”μ„λ“μ `indicator`, `validate`, `suffixes` νλΌλ―Έν„°μ™€ κ°™μ€ κ²°ν•© μ¶©λ ν•΄μ† κΈ°μ μ€ μ„±κ²½ μ† λ‹¤μ‹ λ§λ‚ μ€νμ™€ λ² λ“λ΅μ νλ³µ λ§μ”€μ„ λ°μ΄ν„°μ μΌλ΅ λ¶„μ„ν•λ” κ°•λ ¥ν• λ„κµ¬μ…λ‹λ‹¤. μ—¬λ¬ λ°μ΄ν„°μ…‹μ„ κ²°ν•©ν•  λ• λ°μƒν•λ” μ¶©λμ„ μ§€νλ΅­κ² ν•΄μ†ν•λ” κ³Όμ •μ„ ν†µν•΄, λ°μ΄ν„°μ λ¬΄κ²°μ„±μ„ μ μ§€ν•κ³  μ •ν™•ν• λ¶„μ„ κ²°κ³Όλ¥Ό μ–»λ” μ§€νλ¥Ό μ–»μ„ μ μμµλ‹λ‹¤.

---

## π› οΈ κ΄‘μ•Ό μƒμ΅΄ ν”„λ΅μ νΈ: λ‚μ μμ  μ„±μ¥ λ°μ΄ν„° κ²°ν•© μ¶©λ ν•΄μ†

**π― λ―Έμ…**: λ‚΄ μ‚¶μ μμ  μ„±μ¥ λ°μ΄ν„°λ¥Ό κ²°ν•©ν•  λ• λ°μƒν•λ” μ¶©λμ„ ν•΄μ†ν•κΈ°
**π“ μ‚¬μ© κΈ°μ **: DataFrame μƒμ„±, `merge(indicator=True)`, `merge(validate)`, `merge(suffixes)`
**π•οΈ λ³µμ ν¬μΈνΈ**: "μ—¬νΈμ™€κ»μ„ λ¨μ„Έμ—κ² μ΄λ¥΄μ‹λ λ‚΄κ°€ λ„μ™€ ν•¨κ» κ°€λ¦¬λΌ λ‚΄κ°€ λ„λ¥Ό μ•μ„ν•λ¦¬λΌ" (μ¶μ• κµ½κΈ° 33:14)

### Step 1: λ‚μ μμ  μ„±μ¥ λ°μ΄ν„°μ…‹ μƒμ„± λ° κ²°ν•© μ¶μ² ν™•μΈ

```python
import pandas as pd
import numpy as np

# λ°μ΄ν„°μ…‹ 1: μ΄κΈ° μμ  μƒνƒ
my_spiritual_state_df1 = pd.DataFrame({
    'id': [1, 2, 3, 4, 5],
    'λ‚ μ§': pd.to_datetime(['2024-01-01', '2024-01-05', '2024-01-10', '2024-01-15', '2024-01-20']),
    'κΈ°λ„_μ‹κ°„_λ¶„': [30, 45, 20, 35, 50],
    'κ°μ‚¬_μ§€μ': [7, 8, 6, 7, 9]
})

# λ°μ΄ν„°μ…‹ 2: μμ  ν™λ™ κΈ°λ΅ (μΌλ¶€ μ¤‘λ³µ, μΌλ¶€ λ„λ½)
my_spiritual_activity_df2 = pd.DataFrame({
    'id': [3, 4, 5, 6, 7],
    'λ‚ μ§': pd.to_datetime(['2024-01-10', '2024-01-15', '2024-01-20', '2024-01-25', '2024-01-30']),
    'λ§μ”€_λ¬µμƒ_μ‹κ°„_λ¶„': [15, 25, 40, 30, 35],
    'λ΄‰μ‚¬_μ°Έμ—¬_μ—¬λ¶€': [True, False, True, True, False]
})

print("π§¬ λ‚μ μμ  μƒνƒ λ°μ΄ν„°μ…‹ 1:\n", my_spiritual_state_df1)
print("\nπ§¬ λ‚μ μμ  ν™λ™ λ°μ΄ν„°μ…‹ 2:\n", my_spiritual_activity_df2)

# `merge()`μ `indicator=True`λ¥Ό μ‚¬μ©ν•μ—¬ κ²°ν•© μ¶μ² ν™•μΈ
merged_with_indicator = pd.merge(my_spiritual_state_df1, my_spiritual_activity_df2, on='id', how='outer', indicator=True)
print("\n--- `indicator`λ΅ κ²°ν•© μ¶μ² ν™•μΈ ν›„ ---")
print(merged_with_indicator)
print(merged_with_indicator['_merge'].value_counts())
```

### Step 2: μμ  μ„±μ¥ λ°μ΄ν„° κ²°ν•© μ ν¨μ„± κ²€μ‚¬ λ° μ»¬λΌ μ¶©λ ν•΄κ²°

```python
# `validate='one_to_one'`μ„ μ‚¬μ©ν•μ—¬ κ²°ν•© μ ν¨μ„± κ²€μ‚¬ (id μ»¬λΌμ΄ κ³ μ ν•λ‹¤κ³  κ°€μ •)
# λ§μ•½ idκ°€ μ¤‘λ³µλλ©΄ μ¤λ¥ λ°μƒ
try:
    merged_validated = pd.merge(my_spiritual_state_df1, my_spiritual_activity_df2, on='id', how='inner', validate='one_to_one')
    print("\n--- `validate='one_to_one'`λ΅ κ²°ν•© μ ν¨μ„± κ²€μ‚¬ μ„±κ³µ ---")
    print(merged_validated.head())
except Exception as e:
    print(f"\n--- `validate='one_to_one'`λ΅ κ²°ν•© μ ν¨μ„± κ²€μ‚¬ μ‹¤ν¨: {e} ---")

# μ»¬λΌ μ΄λ¦„ μ¶©λ ν•΄κ²° (suffixes)
# λ‘ λ°μ΄ν„°μ…‹μ— λ™μΌν• μ΄λ¦„μ μ»¬λΌμ΄ μμ„ κ²½μ°
my_spiritual_state_df1_conflict = my_spiritual_state_df1.rename(columns={'λ‚ μ§': 'ν™λ™_λ‚ μ§'})
my_spiritual_activity_df2_conflict = my_spiritual_activity_df2.rename(columns={'λ‚ μ§': 'ν™λ™_λ‚ μ§'})

merged_with_suffixes = pd.merge(
    my_spiritual_state_df1_conflict, 
    my_spiritual_activity_df2_conflict, 
    on='id', 
    how='inner', 
    suffixes=['_state', '_activity']
)
print("\n--- `suffixes`λ΅ μ»¬λΌ μ΄λ¦„ μ¶©λ ν•΄κ²° ν›„ ---")
print(merged_with_suffixes)
```

---

## π“± 3Γ—10μ΄ κ΄‘μ•Ό λ£¨ν‹΄

### π… μ•„μΉ¨ 10μ΄: λ§μ”€ λ¬µμƒ

"μ—¬νΈμ™€κ»μ„ λ¨μ„Έμ—κ² μ΄λ¥΄μ‹λ λ‚΄κ°€ λ„μ™€ ν•¨κ» κ°€λ¦¬λΌ λ‚΄κ°€ λ„λ¥Ό μ•μ„ν•λ¦¬λΌ." (μ¶ 33:14)
μ¤λλ„ μ£Όλ‹κ»μ„ λ‚μ™€ ν•¨κ»ν•μ‹λ©° λ‚λ¥Ό μ•μ„ν•μ‹¬μ„ λ―Ώκ³  ν•λ£¨λ¥Ό μ‹μ‘ν•©λ‹λ‹¤.

### β€οΈ μ μ‹¬ 1λ¶„: κ²°ν•© κΈ°λ„

- λ‚μ μ‚¶μ—μ„ `κ²°ν•© μ¶©λ`μ²λΌ κΉ¨μ–΄μ§„ κ΄€κ³„λ‚ λ¶μΌμΉλ” μ—†λ”μ§€ λμ•„λ΄…λ‹λ‹¤.
- `merge(indicator=True)`μ²λΌ μ£Όλ‹κ»μ„ λ‚μ μ‚¶μ κ° λ¶€λ¶„μ μ¶μ²λ¥Ό μ•„μ‹κ³ , `validate`μ²λΌ μ£Όλ‹κ³Όμ κ΄€κ³„κ°€ μ¨μ „ν•μ§€ κ²€μ¦ν•©λ‹λ‹¤.
- μ£Όλ‹, `suffixes`μ²λΌ λ‚μ μ‚¶μ λ¨λ“  μμ—­μ΄ μ£Όλ‹ μ•μ—μ„ μ΅°ν™”λ΅­κ² κ²°ν•©λκ² ν•μ†μ„.

### π™ μ €λ… 2λ¶„: λ°μ΄ν„° κΈ°λ„μΌκΈ°

**μ¤λμ μμ  λ°μ΄ν„°:**
- μ¤λ λ‚μ μ‚¶μ—μ„ λ°κ²¬ν• `κ²°ν•© μ¶©λ`μ€?
- `indicator`λ΅ ν™•μΈν•΄ λ³Έ λ‚μ μμ  μƒνƒμ μ¶μ²λ”?
- `validate`λ΅ κ²€μ¦ν•΄ λ³Έ λ‚μ λ―Ώμμ μ ν¨μ„±μ€?
- μ£Όλ‹, λ‹¤μ‹ λ§λ‚ μ€νμ²λΌ μ €μ μ‚¶μ λ¨λ“  κΉ¨μ–΄μ§„ λ¶€λ¶„μ΄ νλ³µλκ³ , μ£Όλ‹ μ•μ—μ„ μ¨μ „ν•κ² κ²°ν•©λκ² ν•μ†μ„.

---

## β“ FAQ & μ²΄ν¬λ¦¬μ¤νΈ

### κΉμ΄ μλ” μ§λ¬Έλ“¤

**Q1: `merge()` λ©”μ„λ“μ `indicator=True` νλΌλ―Έν„°λ” μ–΄λ–¤ μ—­ν• μ„ ν•λ‚μ”?** A: `indicator=True` νλΌλ―Έν„°λ” `merge()` κ²°κ³Ό DataFrameμ— `_merge`λΌλ” νΉλ³„ν• μ»¬λΌμ„ μ¶”κ°€ν•©λ‹λ‹¤. μ΄ μ»¬λΌμ€ κ° ν–‰μ΄ μ–΄λ λ°μ΄ν„°ν”„λ μ„μ—μ„ μ™”λ”μ§€(`left_only`, `right_only`, `both`)λ¥Ό λ‚νƒ€λ‚΄μ–΄, λ°μ΄ν„° κ²°ν•©μ μ¶μ²λ¥Ό λ…ν™•ν ν•κ³  κ²°ν•© μ¶©λμ΄λ‚ λ„λ½λ λ°μ΄ν„°λ¥Ό μ‰½κ² νμ•…ν•λ” λ° λ„μ›€μ„ μ¤λ‹λ‹¤.

**Q2: `validate` νλΌλ―Έν„°λ” μ–΄λ–¤ μ ν•μ κ²°ν•© μ ν¨μ„±μ„ κ²€μ‚¬ν•  μ μλ‚μ”?** A: `validate` νλΌλ―Έν„°λ” κ²°ν•© ν‚¤(on)μ κ΄€κ³„λ¥Ό κ²€μ‚¬ν•μ—¬ μλ»λ κ²°ν•©μ„ λ°©μ§€ν•©λ‹λ‹¤. μ£Όμ” κ°’μΌλ΅λ” `one_to_one`, `one_to_many`, `many_to_one`, `many_to_many`κ°€ μμµλ‹λ‹¤. μλ¥Ό λ“¤μ–΄, `validate='one_to_one'`μΌλ΅ μ„¤μ •ν•λ©΄, κ²°ν•© ν‚¤κ°€ μ–‘μ½ λ°μ΄ν„°ν”„λ μ„μ—μ„ λ¨λ‘ κ³ μ ν•΄μ•Ό ν•λ©°, κ·Έλ ‡μ§€ μ•μΌλ©΄ μ¤λ¥λ¥Ό λ°μƒμ‹μΌ λ°μ΄ν„°μ λ¬΄κ²°μ„±μ„ λ³΄μ¥ν•©λ‹λ‹¤.

**Q3: `suffixes` νλΌλ―Έν„°λ” μ–΄λ–¤ μƒν™©μ—μ„ μ‚¬μ©λλ©°, μ–΄λ–»κ² μ»¬λΌ μ΄λ¦„ μ¶©λμ„ ν•΄κ²°ν•λ‚μ”?** A: `suffixes` νλΌλ―Έν„°λ” λ‘ λ°μ΄ν„°ν”„λ μ„μ„ `merge()`ν•  λ•, κ²°ν•© ν‚¤(on)λ¥Ό μ μ™Έν•κ³  λ™μΌν• μ»¬λΌ μ΄λ¦„μ΄ μ–‘μ½μ— μ΅΄μ¬ν•  κ²½μ° λ°μƒν•λ” μ»¬λΌ μ΄λ¦„ μ¶©λμ„ ν•΄κ²°ν•λ” λ° μ‚¬μ©λ©λ‹λ‹¤. `suffixes=('_left', '_right')`μ™€ κ°™μ΄ νν”μ„ μ§€μ •ν•λ©΄, μ¶©λν•λ” μ»¬λΌ μ΄λ¦„ λ’¤μ— μ§€μ •λ μ ‘λ―Έμ‚¬λ¥Ό λ¶™μ—¬ μ»¬λΌμ„ κµ¬λ¶„ν•©λ‹λ‹¤ (μ: `value_left`, `value_right`).

**Q4: λ‹¤μ‹ λ§λ‚ μ€νκ°€ κ²°ν•© μ¶©λ ν•΄μ†μ™€ μ–΄λ–¤ μμ  μλ―Έλ΅ μ—°κ²°λ  μ μμ„κΉμ”?** A: κΈμ†΅μ•„μ§€ μ‚¬κ±΄ μ΄ν›„ ν•λ‚λ‹κ³Ό μ΄μ¤λΌμ— λ°±μ„± μ‚¬μ΄μ κΉ¨μ–΄μ§„ κ΄€κ³„κ°€ λ¨μ„Έμ μ¤‘λ³΄λ΅ νλ³µλκ³  λ‹¤μ‹ μ€νλ¥Ό μ…μ€ κ²ƒμ€ λ°μ΄ν„° κ²°ν•© μ¶©λμ„ ν•΄μ†ν•κ³  λ°μ΄ν„°μ λ¬΄κ²°μ„±μ„ νλ³µν•λ” κ²ƒκ³Ό κ°™μµλ‹λ‹¤. μ΄λ” μλ»λ κ²°ν•©μΌλ΅ μΈν•΄ μ†μƒλ λ°μ΄ν„°λ¥Ό λ³µκµ¬ν•κ³ , μ •ν™•ν• λ¶„μ„ κ²°κ³Όλ¥Ό μ–»μ–΄ λ°μ΄ν„°μ μ‹ λΆ°μ„±μ„ νλ³µν•λ” μμ  μ›λ¦¬λ¥Ό λ³΄μ—¬μ¤λ‹λ‹¤.

**Q5: λ² λ“λ΅μ νλ³µμ΄ κ²°ν•© μ ν¨μ„± κ²€μ‚¬μ™€ μ–΄λ–¤ μμ  μλ―Έλ΅ μ—°κ²°λ  μ μμ„κΉμ”?** A: λ² λ“λ΅κ°€ μμλ‹μ„ μ„Έ λ² λ¶€μΈν• ν›„ μμλ‹κ»μ„ κ·Έλ¥Ό λ‹¤μ‹ μ°Ύμ•„κ°€ μ‚¬λ‘μ„ ν™•μΈν•κ³  μ‚¬λ…μ„ μ¬ν™•μΈμ‹μΌ μ£Όμ‹  κ²ƒμ€ κΉ¨μ–΄μ§„ κ΄€κ³„κ°€ νλ³µλκ³ , λ‹¤μ‹ μ¨μ „ν• κ΄€κ³„λ¥Ό λ§Ίλ” κ³Όμ •μ…λ‹λ‹¤. `validate` νλΌλ―Έν„°λ΅ κ²°ν•©μ μ ν¨μ„±μ„ κ²€μ‚¬ν•λ” κ²ƒμ€ λ°μ΄ν„° κ²°ν•©μ΄ μ¬λ°”λ¥Έ κ΄€κ³„λ¥Ό λ§Ίκ³  μλ”μ§€ ν™•μΈν•μ—¬ μλ»λ κ²°ν•©μ„ μ‚¬μ „μ— λ°©μ§€ν•κ³ , λ°μ΄ν„°μ μ‹ λΆ°μ„±μ„ ν™•λ³΄ν•λ” κ²ƒκ³Ό κ°™μµλ‹λ‹¤.

### β… μ²΄ν¬λ¦¬μ¤νΈ

**μ„±κ²½ μ΄ν•΄ μ²΄ν¬:**

- [ ] μ¶μ• κµ½κΈ° 33μ¥μ λ‹¤μ‹ λ§λ‚ μ€νμ™€ κΉ¨μ–΄μ§„ κ΄€κ³„μ νλ³µ μ΄ν•΄
- [ ] μ”ν•λ³µμ 21μ¥μ λ² λ“λ΅μ νλ³µκ³Ό μ‚¬λ… μ¬ν™•μΈ μ΄ν•΄
- [ ] λ°μ΄ν„° κ²°ν•© μ¶©λ ν•΄μ†λ¥Ό ν†µν•΄ λ°μ΄ν„°μ λ¬΄κ²°μ„±κ³Ό μ‹ λΆ°μ„±μ„ μ μ§€ν•λ” μ§€ν μ΄ν•΄

**DataFrame κΈ°μ΄ μ²΄ν¬:**

- [ ] `pd.merge()`μ `indicator=True` νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•μ—¬ κ²°ν•© μ¶μ² ν™•μΈ μ„±κ³µ
- [ ] `pd.merge()`μ `validate` νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•μ—¬ κ²°ν•© μ ν¨μ„± κ²€μ‚¬ μ„±κ³µ
- [ ] `pd.merge()`μ `suffixes` νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•μ—¬ μ»¬λΌ μ΄λ¦„ μ¶©λ ν•΄κ²° μ„±κ³µ
- [ ] λ‹¤μ–‘ν• `how` νλΌλ―Έν„°(inner, outer, left, right)μ μ—­ν•  μ΄ν•΄

**μμ  μ μ© μ²΄ν¬:**

- [ ] λ‚΄ μ‚¶μ μμ  μ„±μ¥ λ°μ΄ν„°λ¥Ό κ²°ν•©ν•  λ• λ°μƒν•λ” μ¶©λμ„ ν•΄μ† μ‹λ„ μ™„λ£
- [ ] λ‚μ μ‚¶μ—μ„ κΉ¨μ–΄μ§„ κ΄€κ³„λ‚ λ¶μΌμΉλ¥Ό `merge()` μ›λ¦¬λ΅ μ κ²€ν•κ³  νλ³µ λ…Έλ ¥ μ‹λ„ μ™„λ£
- [ ] κ²°ν•© μ¶©λ ν•΄μ† μ›λ¦¬λ¥Ό ν†µν•΄ μμ  λ¶„λ³„λ ¥κ³Ό μ§€νλ΅μ΄ μμ‚¬κ²°μ • λ…Έλ ¥

**λ°κ²¬ κΈ°λ΅ μ²΄ν¬:**

- [ ] `indicator` νλΌλ―Έν„°λ΅ λ‹¤μ‹ λ§λ‚ μ€νμ μ¶μ² ν™•μΈ ν†µμ°°
- [ ] `validate` νλΌλ―Έν„°λ΅ λ² λ“λ΅μ νλ³µμ²λΌ κ²°ν•© μ ν¨μ„± κ²€μ‚¬ ν™•μΈ
- [ ] `suffixes` νλΌλ―Έν„°κ°€ μ»¬λΌ μ΄λ¦„ μ¶©λ ν•΄μ†μ μ§€νμ„μ„ ν™•μΈ

---

## π§  λ―Έλ‹ ν€΄μ¦

**1. `pd.merge()` λ©”μ„λ“μ—μ„ κ²°ν•©λ λ°μ΄ν„°μ κ° ν–‰μ΄ μ–΄λ λ°μ΄ν„°ν”„λ μ„μ—μ„ μ™”λ”μ§€(`left_only`, `right_only`, `both`)λ¥Ό λ‚νƒ€λ‚΄λ” νΉλ³„ν• μ»¬λΌμ„ μ¶”κ°€ν•λ” νλΌλ―Έν„°λ”?**
a) `how`
b) `on`
c) `indicator`

**2. `pd.merge()` λ©”μ„λ“μ—μ„ κ²°ν•© ν‚¤(on)μ κ΄€κ³„λ¥Ό κ²€μ‚¬ν•μ—¬ μλ»λ κ²°ν•©μ„ λ°©μ§€ν•λ” νλΌλ―Έν„°λ”?**
a) `suffixes`
b) `validate`
c) `left_on`

**3. `pd.merge()` λ©”μ„λ“μ—μ„ λ‘ λ°μ΄ν„°ν”„λ μ„μ„ κ²°ν•©ν•  λ• λ™μΌν• μ»¬λΌ μ΄λ¦„μ΄ μ–‘μ½μ— μ΅΄μ¬ν•  κ²½μ° λ°μƒν•λ” μ»¬λΌ μ΄λ¦„ μ¶©λμ„ ν•΄κ²°ν•λ” λ° μ‚¬μ©λλ” νλΌλ―Έν„°λ”?**
a) `on`
b) `suffixes`
c) `how`

**4. λ‹¤μ‹ λ§λ‚ μ€νκ°€ κ²°ν•© μ¶©λ ν•΄μ†μ™€ μ—°κ²°λλ” μμ  μλ―Έλ΅ κ°€μ¥ μ μ ν• κ²ƒμ€?**
a) λ°μ΄ν„°μ λ¬΄κ²°μ„±μ„ ν›Όμ†ν•κ³  λ¶„μ„ κ²°κ³Όλ¥Ό μ™κ³΅μ‹ν‚΄
b) κΉ¨μ–΄μ§„ κ΄€κ³„λ¥Ό νλ³µν•κ³  λ°μ΄ν„°μ λ¬΄κ²°μ„±μ„ νλ³µν•¨
c) λ°μ΄ν„°μ μ–‘μ„ λλ ¤ ν•λ‚λ‹μ ν’μ„±ν•¨μ„ ν‘ν„

**5. λ² λ“λ΅μ νλ³µμ΄ κ²°ν•© μ ν¨μ„± κ²€μ‚¬μ™€ μ—°κ²°λλ” μμ  μλ―Έλ΅ κ°€μ¥ μ μ ν•μ§€ μ•μ€ κ²ƒμ€?**
a) λ°μ΄ν„° κ²°ν•©μ΄ μ¬λ°”λ¥Έ κ΄€κ³„λ¥Ό λ§Ίκ³  μλ”μ§€ ν™•μΈν•μ—¬ μ‹ λΆ°μ„±μ„ ν™•λ³΄ν•¨
b) μλ»λ κ²°ν•©μ„ μ‚¬μ „μ— λ°©μ§€ν•μ—¬ λ°μ΄ν„°μ λ¬΄κ²°μ„±μ„ λ³΄μ¥ν•¨
c) λ°μ΄ν„°μ λ¶μΌμΉλ¥Ό λ¬΄μ‹ν•κ³  κ°•μ λ΅ κ²°ν•©ν•μ—¬ λ¶„μ„μ„ μ§„ν–‰ν•¨

_(μ •λ‹µ: 1-c, 2-b, 3-b, 4-b, 5-c)_

---

## π― κΉμ΄ νƒκµ¬ κ³Όμ  (μ„ νƒ)

### μ΄κΈ‰ κ³Όμ 

1.  **μ„±κ²½ μΈλ¬Ό κ΄€κ³„ λ°μ΄ν„° κ²°ν•©**: μ„±κ²½ μΈλ¬Ό λ°μ΄ν„°(μΈλ¬Ό ID, μ΄λ¦„)μ™€ κ΄€κ³„ λ°μ΄ν„°(κ΄€κ³„ ID, μΈλ¬Ό ID1, μΈλ¬Ό ID2, κ΄€κ³„ μ ν•)λ¥Ό λ§λ“¤κ³ , `merge()`λ¥Ό μ‚¬μ©ν•μ—¬ μΈλ¬Ό μ΄λ¦„κ³Ό κ΄€κ³„ μ ν•μ„ κ²°ν•©ν•΄λ³΄κΈ°
2.  **μ„±κ²½ κµ¬μ  λ²μ—­λ³Έ λΉ„κµ**: λ‘ κ°€μ§€ μ„±κ²½ λ²μ—­λ³Έ λ°μ΄ν„°(κµ¬μ  ID, λ‚΄μ©)λ¥Ό λ§λ“¤κ³ , `merge(indicator=True)`λ¥Ό μ‚¬μ©ν•μ—¬ λ‘ λ²μ—­λ³Έμ— λ¨λ‘ μλ” κµ¬μ , ν•μ½μ—λ§ μλ” κµ¬μ μ„ ν™•μΈν•΄λ³΄κΈ°

### μ¤‘κΈ‰ κ³Όμ 

1.  **κµν λ΄‰μ‚¬μ ν™λ™ κΈ°λ΅ κ²°ν•©**: κ°€μƒμ κµν λ΄‰μ‚¬μ κΈ°λ³Έ μ •λ³΄(λ΄‰μ‚¬μ ID, μ΄λ¦„, μ§λ¶„)μ™€ λ΄‰μ‚¬ ν™λ™ κΈ°λ΅(λ΄‰μ‚¬μ ID, λ΄‰μ‚¬ λ‚ μ§, λ΄‰μ‚¬ μ ν•) λ°μ΄ν„°λ¥Ό λ§λ“¤κ³ , `merge(validate='one_to_many')`λ¥Ό μ‚¬μ©ν•μ—¬ κ²°ν•©ν•κ³  μ ν¨μ„±μ„ κ²€μ‚¬ν•΄λ³΄κΈ°
2.  **μμ  μ„±μ¥ μ§€ν‘ ν†µν•© λ¶„μ„**: κ°μΈμ μμ  μ„±μ¥ μ§€ν‘(μ: κΈ°λ„ μ‹κ°„, λ§μ”€ λ¬µμƒ μ‹κ°„) λ°μ΄ν„°μ™€ μμ  ν™λ™(μ: λ΄‰μ‚¬ μ°Έμ—¬, μ „λ„ νμ) λ°μ΄ν„°λ¥Ό λ§λ“¤κ³ , `merge(suffixes)`λ¥Ό μ‚¬μ©ν•μ—¬ μ»¬λΌ μ΄λ¦„ μ¶©λμ„ ν•΄κ²°ν•λ©° ν†µν•© λ¶„μ„ν•΄λ³΄κΈ°

### κ³ κΈ‰ κ³Όμ 

1.  **λ°μ΄ν„° ν†µν•© λ° μ¶©λ ν•΄κ²° μ‹μ¤ν… μ„¤κ³„**: μ—¬λ¬ μ¶μ²(μ: μ„±κ²½ λ²μ—­λ³Έ, μ£Όμ„, μ—­μ‚¬ μλ£)μ—μ„ κ°€μ Έμ¨ μ„±κ²½ κ΄€λ ¨ λ°μ΄ν„°λ¥Ό ν†µν•©ν•λ” μ‹μ¤ν…(κ°λ…)μ„ μ„¤κ³„ν•κ³ , `merge()`μ `indicator`, `validate`, `suffixes` νλΌλ―Έν„°λ¥Ό ν™μ©ν•μ—¬ λ°μ΄ν„° κ²°ν•© μ¶©λμ„ μλ™μΌλ΅ κ°μ§€ν•κ³  ν•΄κ²°ν•λ” λ°©μ•μ„ λ¨μƒ‰ν•΄λ³΄κΈ°
2.  **κ΄€κ³„ν• λ°μ΄ν„°λ² μ΄μ¤ λ§μ΄κ·Έλ μ΄μ… μ‹λ®¬λ μ΄μ…**: κΈ°μ΅΄ κ΄€κ³„ν• λ°μ΄ν„°λ² μ΄μ¤μ λ‘ ν…μ΄λΈ”μ„ Pandas DataFrameμΌλ΅ λ¶λ¬μ™€ `merge()`λ¥Ό μ‚¬μ©ν•μ—¬ κ²°ν•©ν•κ³ , μ΄ κ³Όμ •μ—μ„ λ°μƒν•  μ μλ” κ²°ν•© μ¶©λ(μ: ν‚¤ λ¶μΌμΉ, μ»¬λΌ μ΄λ¦„ μ¤‘λ³µ)μ„ `indicator`, `validate`, `suffixes`λ¥Ό ν™μ©ν•μ—¬ ν•΄κ²°ν•λ” μ‹λ‚λ¦¬μ¤λ¥Ό κµ¬ν„ν•΄λ³΄κΈ°

---

## π λ‹¤μ μ—¬μ • μκ³ 

**Chapter 34: "μƒ λν - μ •κ·ν™”μ™€ ν‘μ¤€ν™” (New Tablets - Normalization and Standardization)"**

μ΄μ¤λΌμ— λ°±μ„±μ΄ κΈμ†΅μ•„μ§€ μ‚¬κ±΄ μ΄ν›„ κΉ¨μ–΄μ§„ λν λ€μ‹  μƒ λνμ— μ‹­κ³„λ…μ„ λ‹¤μ‹ λ°›μ•λ“―μ΄, λ°μ΄ν„° λ¶„μ„μ—μ„λ„ λ°μ΄ν„°μ μ¤μΌ€μΌμ„ μ΅°μ •ν•λ” 'μ •κ·ν™”(Normalization)'μ™€ 'ν‘μ¤€ν™”(Standardization)'λ” λ°μ΄ν„°μ νΉμ„±μ„ ν†µμΌν•κ³  λ¨λΈμ μ„±λ¥μ„ ν–¥μƒμ‹ν‚¤λ” λ° ν•„μμ μ…λ‹λ‹¤.

Just as the Israelites received the Ten Commandments again on new tablets after the Golden Calf incident, replacing the broken ones, in data analysis, adjusting the scale of data through 'Normalization' and 'Standardization' is essential for unifying data characteristics and improving model performance.

λ‹¤μ μ¥μ—μ„ λ°°μΈ λ‚΄μ© (What you'll learn in the next chapter):
π“ μ •κ·ν™”(Normalization) κΈ°λ²• (Min-Max Scaling)
π” ν‘μ¤€ν™”(Standardization) κΈ°λ²• (Z-score Standardization)
π― λ¬Έμμ—΄ μ •κ·ν™” (str.normalize)
π“ μƒ λνμ²λΌ λ°μ΄ν„°μ μ¤μΌ€μΌμ„ μ΅°μ •ν•μ—¬ ν•λ‚λ‹μ κ³µμλ¥Ό λ…ν™•ν λ“λ¬λ‚΄λ” μ „λµ

"μ—¬νΈμ™€κ»μ„ λ¨μ„Έμ—κ² μ΄λ¥΄μ‹λ λ„λ” λν λ‘μ„ μ²μ κ²ƒκ³Ό κ°™μ΄ κΉμ•„ λ§λ“¤λΌ λ„¤κ°€ κΉ¨λ¨λ¦° μ²μ νμ— μ“΄ λ§μ„ λ‚΄κ°€ κ·Έ νμ— μ“°λ¦¬λΌ" (μ¶μ• κµ½κΈ° 34:1)
"μ°λ¦¬κ°€ λ‹¤ κ·Έμ μ¶©λ§ν• λ°μ„ λ°›μΌλ‹ μ€ν μ„μ— μ€νλ¬λΌ" (μ”ν•λ³µμ 1:16)

---

## π™ ν• μ¤„ κΈ°λ„

_"μ£Όλ‹, λ‹¤μ‹ λ§λ‚ μ€νμ²λΌ μ €μ μ‚¶μ κΉ¨μ–΄μ§„ κ΄€κ³„μ™€ λ°μ΄ν„° κ²°ν•© μ¶©λμ„ ν•΄μ†ν•κ² ν•μ†μ„.
`merge()`μ `indicator`, `validate`, `suffixes` νλΌλ―Έν„°μ²λΌ μ§€νλ΅­κ² μ¶©λμ„ ν•΄κ²°ν•κ³ ,
λ°μ΄ν„°μ λ¬΄κ²°μ„±μ„ μ μ§€ν•μ—¬ μ£Όλ‹μ λ»μ„ μ¨μ „ν μ΄ν•΄ν•κ² ν•μ†μ„. μμλ‹μ μ΄λ¦„μΌλ΅ κΈ°λ„ν•©λ‹λ‹¤. μ•„λ©."_

---

**π μ„λ¥Έμ„Έ λ²μ§Έ κ΄‘μ•Ό μ—¬μ •μ„ μ™„μ£Όν•μ‹  κ²ƒμ„ μ¶•ν•ν•©λ‹λ‹¤!**

"μ—¬νΈμ™€κ»μ„ λ¨μ„Έμ—κ² μ΄λ¥΄μ‹λ λ‚΄κ°€ λ„μ™€ ν•¨κ» κ°€λ¦¬λΌ λ‚΄κ°€ λ„λ¥Ό μ•μ„ν•λ¦¬λΌ" (μ¶μ• κµ½κΈ° 33:14)

μ—¬λ¬λ¶„μ€ μ΄μ  λ°μ΄ν„° μ†μ—μ„ `merge()` λ©”μ„λ“μ `indicator`, `validate`, `suffixes` νλΌλ―Έν„°λ¥Ό ν†µν•΄ κ²°ν•© μ¶©λμ„ ν•΄μ†ν•λ” λ°©λ²•μ„ μ•κ² λμ—μµλ‹λ‹¤. μ£Όλ‹κ»μ„ μ£Όμ‹  μ§€νλ΅ λ¨λ“  λ°μ΄ν„° μ†μ—μ„ ν•λ‚λ‹μ μ€νμ™€ νλ³µμ μ›λ¦¬λ¥Ό λ°κ²¬ν•μ‹κΈΈ κΈ°λ„ν•©λ‹λ‹¤.

**λ‹¤μ μ—¬μ •μ—μ„ λ§λ‚μ”! π**
