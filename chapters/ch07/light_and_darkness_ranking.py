import pandas as pd
import numpy as np

def analyze_spiritual_ranking():
    """ìš”í•œë³µìŒ 3:16-21 ë¹›ê³¼ ì–´ë‘ ì˜ ì˜ì  ìˆœìœ„ ë¶„ì„"""
    print("\nğŸ’¡ ë¹›ê³¼ ì–´ë‘ ì˜ ì˜ì  ìˆœìœ„: í–‰ìœ„ì— ë”°ë¥¸ ì‹¬íŒ")
    print("=" * 50)

    spiritual_status = pd.DataFrame({
        'í–‰ìœ„_ìœ í˜•': ['í•˜ë‚˜ë‹˜ ì‚¬ë‘', 'ì–´ë‘ ì„ ì‚¬ë‘', 'ì§„ë¦¬ë¥¼ í–‰í•¨', 'ì•…ì„ í–‰í•¨', 'ì˜ˆìˆ˜ë‹˜ ë¯¿ìŒ', 'ë¹›ì„ ë¯¸ì›Œí•¨'],
        'ì˜ì _ê°€ì¹˜': [10, 1, 9, 2, 9.5, 0.5], # 0-10 ìŠ¤ì¼€ì¼
        'ê²°ê³¼': ['ë¹›ìœ¼ë¡œ ë‚˜ì˜´', 'ì–´ë‘ ì— ë¨¸ë­„', 'í•˜ë‚˜ë‹˜ ì•ˆì— ìˆìŒ', 'ì •ì£„ ë°›ìŒ', 'ì˜ìƒ ì–»ìŒ', 'ì •ì£„ ë°›ìŒ'],
        'êµ¬ì›_ê°€ëŠ¥ì„±_ì§€ìˆ˜': [0.9, 0.1, 0.8, 0.2, 1.0, 0.0] # 0-1 ìŠ¤ì¼€ì¼
    })
    print(spiritual_status)

    # 'ì˜ì _ê°€ì¹˜'ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
    sorted_by_spiritual_value = spiritual_status.sort_values(by='ì˜ì _ê°€ì¹˜', ascending=False)
    print("\nğŸ“ˆ ì˜ì  ê°€ì¹˜ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬ (ë‚´ë¦¼ì°¨ìˆœ):")
    print(sorted_by_spiritual_value[['í–‰ìœ„_ìœ í˜•', 'ì˜ì _ê°€ì¹˜', 'ê²°ê³¼']])

    # 'êµ¬ì›_ê°€ëŠ¥ì„±_ì§€ìˆ˜'ì— ë”°ë¥¸ ìˆœìœ„ ë§¤ê¸°ê¸° (ë‚´ë¦¼ì°¨ìˆœ, ë™ì¼ ìˆœìœ„ëŠ” ê°€ì¥ ë†’ì€ ìˆœìœ„ ë¶€ì—¬)
    spiritual_status['êµ¬ì›_ê°€ëŠ¥ì„±_ìˆœìœ„'] = spiritual_status['êµ¬ì›_ê°€ëŠ¥ì„±_ì§€ìˆ˜'].rank(ascending=False, method='first')
    print("\nğŸ† êµ¬ì› ê°€ëŠ¥ì„± ìˆœìœ„:")
    print(spiritual_status[['í–‰ìœ„_ìœ í˜•', 'êµ¬ì›_ê°€ëŠ¥ì„±_ì§€ìˆ˜', 'êµ¬ì›_ê°€ëŠ¥ì„±_ìˆœìœ„']].sort_values(by='êµ¬ì›_ê°€ëŠ¥ì„±_ìˆœìœ„'))

    # ê°€ì¥ êµ¬ì› ê°€ëŠ¥ì„±ì´ ë†’ì€ 2ê°€ì§€ í–‰ìœ„ ì°¾ê¸° (`nlargest`)
    top_spiritual_acts = spiritual_status.nlargest(2, 'êµ¬ì›_ê°€ëŠ¥ì„±_ì§€ìˆ˜')
    print("\nâœ¨ ê°€ì¥ ë†’ì€ êµ¬ì› ê°€ëŠ¥ì„±ì„ ê°€ì§„ í–‰ìœ„ 2ê°€ì§€:")
    print(top_spiritual_acts[['í–‰ìœ„_ìœ í˜•', 'êµ¬ì›_ê°€ëŠ¥ì„±_ì§€ìˆ˜']])

    return spiritual_status

def main():
    analyze_spiritual_ranking()

if __name__ == "__main__":
    main()
