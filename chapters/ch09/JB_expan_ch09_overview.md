# Chapter 09. 견고한 마음 — 집계의 기초

> 🗺️ **출애굽 여정**: "출 9장 - 다섯, 여섯, 일곱 번째 재앙"
> 📊 **요한복음 데이터**: "요 4:46–54 - 왕의 신하의 아들을 고치심"

_"여호와의 손이 들에 있는 네 생축에게 더하리니... 심한 악질이 있을 것이며" (출애굽기 9:3)_

→ 파라오의 마음이 견고해질수록 재앙은 더욱 심해졌습니다. 데이터 분석에서 '집계'는 복잡한 현상 속에서 핵심적인 패턴과 요약을 찾아내는 과정입니다. 이는 마치 수많은 재앙 속에서 하나님의 메시지를 파악하고, 믿음의 여정에서 중요한 변화를 포착하는 것과 같습니다.

---

## 📜 성경 본문 깊이 묵상

### 출애굽기 9장: 다섯, 여섯, 일곱 번째 재앙과 파라오의 견고한 마음

출애굽기 9장에서는 다섯 번째 재앙(악질), 여섯 번째 재앙(독종), 일곱 번째 재앙(우박)이 기록되어 있습니다. 이 재앙들은 애굽에 막대한 피해를 입혔지만, 파라오의 마음은 더욱 견고해졌습니다. 특히 다섯 번째 재앙에서는 이스라엘 자손의 생축은 하나도 죽지 않았음이 명확히 구분됩니다.

- **다섯 번째 재앙 (악질):** 애굽의 모든 생축이 죽었으나 이스라엘 자손의 생축은 하나도 죽지 않음 (출 9:3-7)
- **여섯 번째 재앙 (독종):** 사람과 짐승에게 독종이 발하여 애굽의 술객들도 모세 앞에 서지 못함 (출 9:8-12)
- **일곱 번째 재앙 (우박):** 애굽 땅에 우박이 내려 사람과 짐승, 밭의 채소와 나무를 침 (출 9:18-26)

이러한 재앙의 기록은 데이터의 '집계'를 통해 그 심각성과 영향을 요약하고 비교하는 데 영감을 줍니다. 각 재앙이 미친 영향의 총합, 평균, 발생 횟수 등을 통해 파라오의 완악함과 하나님의 권능을 더 깊이 이해할 수 있습니다.

### 요한복음 4:46–54: 왕의 신하의 아들을 고치심

예수님께서 갈릴리 가나에 다시 오셨을 때, 가버나움에 사는 한 왕의 신하가 자기 아들이 병들어 죽게 되자 예수님께 나아와 고쳐달라고 간청합니다. 예수님은 "가라 네 아들이 살았다"고 말씀하시고, 신하는 예수님의 말씀을 믿고 돌아갑니다. 집에 가는 도중 종들이 나와 아들이 나았다고 전하는데, 나은 시각이 예수님께서 말씀하신 그 시각임을 알고 신하와 그 온 집이 다 믿게 됩니다.

- **간청:** 아들이 죽게 되어 예수님께 나아옴 (요 4:47)
- **예수님의 말씀:** "가라 네 아들이 살았다" (요 4:50)
- **믿음:** 신하가 예수님의 말씀을 믿고 돌아감 (요 4:50)
- **확인:** 종들이 아들이 나았음을 알림 (요 4:51)
- **깨달음:** 나은 시각이 예수님 말씀하신 시각과 일치함을 확인 (요 4:52)
- **결과:** 신하와 온 집이 다 믿음 (요 4:53)

이 이야기 속에서 우리는 신하의 믿음의 여정, 아들의 병세 변화, 그리고 예수님의 말씀의 권능을 데이터로 '집계'하여 분석할 수 있습니다. 예를 들어, 믿음의 수준 변화, 병세의 평균적인 호전 정도, 사건 발생 횟수 등을 통해 이 기적의 의미를 더 깊이 탐구할 수 있습니다.

---

## 🔍 숨겨진 질문 발견

**출애굽기에서 발견할 질문들:**

- 각 재앙의 '심각도'를 어떻게 수치화하고 비교할 수 있을까?
- 이스라엘 백성과 애굽 백성에게 미친 재앙의 '평균적인' 영향은 어떻게 달랐을까?
- 파라오의 마음이 견고해진 '횟수'와 재앙의 '심각도' 사이에 상관관계가 있을까?

**요한복음에서 발견할 질문들:**

- 왕의 신하의 '믿음 수준'은 예수님을 만나기 전과 후, 그리고 아들이 나은 것을 확인한 후 어떻게 '평균적으로' 변화했을까?
- 아들의 '병세'는 예수님의 말씀 이후 얼마나 '빠르게' 호전되었을까?
- 신하의 믿음이 '확인'되는 과정에서 어떤 '사건들'이 발생했으며, 그 수는 몇 개일까?

이런 질문들은 데이터의 '집계'라는 관점으로 성경 본문을 더 깊이 이해하는 데 도움을 줄 것이다.

---

## 📊 판다스로 성경 탐구하기

### 탐구 1: 재앙의 영향 집계 분석 (describe, sum, mean, count)

```python
import pandas as pd
from .plagues_data import generate_plague_data

# 재앙 데이터 생성
df_plagues = generate_plague_data()

print("🔥 재앙 데이터 요약:")
print(df_plagues)

# describe()를 사용하여 수치형 데이터 요약 통계 확인
print("\n--- 재앙 심각도 요약 통계 ---")
print(df_plagues['severity_egypt'].describe())

# sum()을 사용하여 이집트의 총 피해 심각도 계산
total_severity_egypt = df_plagues['severity_egypt'].sum()
print(f"\n총 이집트 피해 심각도: {total_severity_egypt}")

# mean()을 사용하여 재앙의 평균 심각도 계산
mean_severity_egypt = df_plagues['severity_egypt'].mean()
print(f"평균 이집트 피해 심각도: {mean_severity_egypt:.2f}")

# count()를 사용하여 기록된 재앙의 수 계산
num_recorded_plagues = df_plagues['plague_name'].count()
print(f"기록된 재앙의 수: {num_recorded_plagues}")

# 고센이 보호받은 재앙의 수 (protected_goshen이 True인 경우)
protected_goshen_count = df_plagues[df_plagues['protected_goshen'] == True]['plague_name'].count()
print(f"고센이 보호받은 재앙의 수: {protected_goshen_count}")
```

### 탐구 2: 왕의 신하의 믿음 여정 집계 분석 (mean, count, describe)

```python
import pandas as pd
from .officials_son_data import generate_healing_data

# 치유 여정 데이터 생성
df_healing = generate_healing_data()

print("\n🙏 왕의 신하의 믿음 여정 요약:")
print(df_healing)

# describe()를 사용하여 수치형 데이터 요약 통계 확인
print("\n--- 믿음 수준 및 시간 요약 통계 ---")
print(df_healing[['father_faith_level', 'time_from_request_hours']].describe())

# mean()을 사용하여 아버지의 평균 믿음 수준 계산
average_faith_level = df_healing['father_faith_level'].mean()
print(f"\n아버지의 평균 믿음 수준: {average_faith_level:.2f}")

# count()를 사용하여 기록된 사건의 수 계산
num_healing_events = df_healing['event'].count()
print(f"기록된 치유 여정 사건 수: {num_healing_events}")

# 'High' 열 상태의 사건 수 계산
high_fever_events = df_healing[df_healing['fever_status'] == 'High']['event'].count()
print(f"고열 상태 사건 수: {high_fever_events}")
```

---

## ⭐ 놀라운 발견들

### 발견 1: 재앙의 심각도와 하나님의 구분

`describe()`와 `sum()`을 통해 애굽에 내려진 재앙의 총체적인 심각도를 파악할 수 있습니다. 특히 `protected_goshen` 열을 필터링하여 `count()`하면, 하나님께서 이스라엘 백성을 애굽 백성과 명확히 구분하셨음을 수치적으로 확인할 수 있습니다. 이는 하나님의 공의와 보호하심을 데이터로 증명하는 강력한 증거가 됩니다.

### 발견 2: 믿음의 점진적 성장과 말씀의 능력

왕의 신하의 믿음 수준을 `mean()`으로 집계하면, 예수님의 말씀을 듣고 아들이 나았음을 확인하는 과정에서 믿음이 점진적으로 성장했음을 알 수 있습니다. `count()`를 통해 사건의 흐름을 파악하고, `describe()`로 시간의 변화를 요약하면, 예수님의 말씀 한마디가 시공간을 초월하여 역사하는 능력을 데이터로 묵상할 수 있습니다.

### 발견 3: 집계는 복잡성 속의 단순성

수많은 재앙과 사건들 속에서 `sum()`, `mean()`, `count()`, `describe()`와 같은 집계 함수는 복잡한 데이터를 단순하고 의미 있는 정보로 요약해 줍니다. 이는 마치 성경의 방대한 이야기 속에서 하나님의 핵심 메시지와 구원의 패턴을 찾아내는 것과 같습니다. 집계는 혼돈 속에서 질서를 발견하는 영적인 통찰력을 제공합니다.

---

## 🎨 블렌딩 모드: 출애굽 × 요한복음의 통합 통찰

|출애굽기 진리|요한복음 진리|판다스 도구|영적 발견|
|---|---|---|---|
|재앙의 심각성과 애굽의 고통|아들의 병세와 신하의 간절함|`sum()`, `mean()`|고통 속에서 하나님의 개입을 구하는 인간의 모습|
|이스라엘과 애굽의 명확한 구분|예수님의 말씀과 기적의 시점 일치|`count()`, 불리언 필터|하나님의 주권적인 보호와 정확한 타이밍|
|파라오의 견고한 마음|신하의 점진적인 믿음 성장|`describe()`|인간의 반응과 하나님의 역사의 상호작용|
|재앙의 반복과 패턴|믿음의 확인과 온 집의 구원|데이터 요약 및 비교|하나님의 일하심에는 일관된 패턴과 목적이 있음|
|하나님의 권능의 증거|예수님의 신성한 능력의 증거|데이터 시각화 (미리보기)|데이터를 통해 드러나는 하나님의 영광|

> **💎 블렌딩 결과**: '집계'는 복잡한 사건들 속에서 하나님의 일하심의 규모와 패턴을 요약하고, 인간의 반응(견고함, 믿음)을 수치적으로 이해하는 데 도움을 줍니다. 이는 데이터 속에서 하나님의 메시지를 발견하는 강력한 도구입니다.

---

## 🛠️ 광야 생존 프로젝트: 나의 영적 상태 집계 분석

**🎯 미션**: 내 삶의 영적 상태를 데이터로 기록하고 집계 분석하기
**📊 사용 기술**: DataFrame 생성, `describe()`, `sum()`, `mean()`, `count()`
**🕊️ 복음 포인트**: "너희는 마음에 근심하지 말라 하나님을 믿으니 또 나를 믿으라" (요한복음 14:1)

### Step 1: 나의 영적 데이터 기록

```python
# 내 삶의 영적 데이터
my_spiritual_data = pd.DataFrame({
    '날짜': pd.to_datetime(['2024-01-01', '2024-01-02', '2024-01-03', '2024-01-04', '2024-01-05']),
    '기도_시간_분': [30, 45, 20, 60, 35],
    '성경_읽은_장수': [3, 5, 2, 7, 4],
    '감사_항목_수': [5, 7, 3, 10, 6],
    '죄_고백_횟수': [1, 0, 2, 0, 1],
    '평안_지수': [7, 8, 6, 9, 7] # 1-10 스케일
})

print("🧬 나의 영적 데이터 요약:")
print(my_spiritual_data)

# describe()로 전체 요약 통계 확인
print("\n--- 나의 영적 상태 요약 통계 ---")
print(my_spiritual_data.describe())

# 기도 시간의 총합과 평균
total_prayer_time = my_spiritual_data['기도_시간_분'].sum()
mean_prayer_time = my_spiritual_data['기도_시간_분'].mean()
print(f"\n총 기도 시간: {total_prayer_time}분, 평균 기도 시간: {mean_prayer_time:.2f}분")

# 성경 읽은 날짜 수
days_read_bible = my_spiritual_data[my_spiritual_data['성경_읽은_장수'] > 0]['날짜'].count()
print(f"성경을 읽은 날짜 수: {days_read_bible}일")
```

### Step 2: 나의 '근심' 데이터 집계

```python
# 내 마음 속 근심 데이터
my_worries = pd.DataFrame({
    '근심_내용': ['재정', '건강', '미래', '관계', '학업'],
    '심각도': [8, 7, 9, 6, 7], # 1-10 스케일
    '빈도_주간': [3, 2, 4, 1, 3],
    '기도_필요_여부': [True, True, True, True, True]
})

print("💡 내 마음 속 근심 데이터 요약:")
print(my_worries)

# describe()로 근심의 심각도와 빈도 요약
print("\n--- 근심 심각도 및 빈도 요약 통계 ---")
print(my_worries[['심각도', '빈도_주간']].describe())

# 총 근심 심각도 합계
total_worry_severity = my_worries['심각도'].sum()
print(f"\n총 근심 심각도 합계: {total_worry_severity}")

# 평균 근심 빈도
mean_worry_frequency = my_worries['빈도_주간'].mean()
print(f"평균 근심 빈도 (주간): {mean_worry_frequency:.2f}회")
```

---

## 📱 3×10초 광야 루틴

### 🌅 아침 10초: 말씀 묵상

"하나님을 믿으니 또 나를 믿으라." (요 14:1)
오늘 하루도 주님을 신뢰하며 모든 근심을 주님께 맡깁니다.

### ☀️ 점심 1분: 집계 기도

- 오늘 나의 영적 상태 데이터(기도, 말씀, 감사)를 집계해 봅니다.
- 나의 근심 데이터(심각도, 빈도)를 주님께 아뢰고, 주님의 평안을 구합니다.
- 주님, 저의 모든 것을 아시오니, 주님의 뜻대로 인도하소서.

### 🌙 저녁 2분: 데이터 기도일기

**오늘의 영적 데이터:**
- 오늘 나의 영적 활동(기도, 말씀, 감사)의 총합과 평균은?
- 오늘 나를 괴롭혔던 근심의 심각도와 빈도는?
- 주님께서 주신 평안 지수는?

---

## ❓ FAQ & 체크리스트

### 깊이 있는 질문들

**Q1: 집계 함수는 언제 사용해야 하나요?** A: 데이터의 전체적인 경향, 요약 정보, 총합, 평균 등을 빠르게 파악하고 싶을 때 사용합니다. 예를 들어, 특정 기간 동안의 총 매출, 평균 고객 만족도, 발생한 이벤트의 총 횟수 등을 계산할 때 유용합니다.

**Q2: `describe()` 함수는 어떤 정보를 제공하나요?** A: `describe()`는 수치형 데이터에 대해 개수(count), 평균(mean), 표준편차(std), 최솟값(min), 25/50/75% 사분위수(25%/50%/75%), 최댓값(max) 등 다양한 요약 통계량을 한 번에 보여줍니다. 데이터의 분포를 빠르게 이해하는 데 매우 효과적입니다.

**Q3: 파라오의 마음이 견고해진 것을 데이터로 어떻게 표현할 수 있을까요?** A: 파라오의 반응을 수치화하여 '완악함 지수'와 같은 지표를 만들 수 있습니다. 재앙의 심각도와 파라오의 순종 여부를 결합하여, 재앙이 반복될수록 지수가 높아지는 방식으로 표현하고, 이를 `sum()`이나 `mean()`으로 집계하여 변화를 분석할 수 있습니다.

**Q4: 왕의 신하의 믿음 성장을 데이터로 어떻게 시각화할 수 있을까요?** A: 시간의 흐름에 따른 'father_faith_level'의 변화를 선 그래프로 시각화할 수 있습니다. 각 사건(예수님 말씀, 종들의 보고, 아들 완치 확인) 시점의 믿음 수준을 점으로 표시하여 믿음의 점진적인 성장을 보여줄 수 있습니다.

**Q5: `count()`와 `sum()`의 차이점은 무엇인가요?** A: `count()`는 결측값을 제외한 유효한 데이터의 개수를 세는 반면, `sum()`은 모든 유효한 데이터 값들을 더한 총합을 계산합니다. 예를 들어, '기도_시간_분' 열에서 `count()`는 기도한 날의 수를, `sum()`은 총 기도 시간을 나타냅니다.

### ✅ 체크리스트

**성경 이해 체크:**

- [ ] 출애굽기 9장의 재앙들과 파라오의 반응 이해
- [ ] 요한복음 4장의 왕의 신하 이야기와 믿음의 과정 파악
- [ ] 재앙과 치유 이야기 속에서 하나님의 권능과 인간의 반응 이해

**DataFrame 기초 체크:**

- [ ] `describe()` 함수를 사용하여 요약 통계 확인 성공
- [ ] `sum()` 함수를 사용하여 총합 계산 성공
- [ ] `mean()` 함수를 사용하여 평균 계산 성공
- [ ] `count()` 함수를 사용하여 개수 계산 성공

**영적 적용 체크:**

- [ ] 내 삶의 영적 데이터를 기록하고 집계 분석 시도 완료
- [ ] 내 마음 속 근심 데이터를 집계하고 주님께 아뢰는 시간 가짐
- [ ] 집계 원리를 통해 복잡한 삶 속에서 하나님의 메시지 발견 고민

**발견 기록 체크:**

- [ ] 재앙의 심각도와 하나님의 구분을 데이터로 확인
- [ ] 믿음의 점진적 성장과 말씀의 능력을 데이터로 묵상
- [ ] 집계가 복잡성 속의 단순성을 제공함을 통찰

---

## 🧠 미니 퀴즈

**1. `DataFrame`의 수치형 데이터에 대한 개수, 평균, 표준편차 등을 한 번에 보여주는 함수는?**
a) `sum()`
b) `mean()`
c) `describe()`

**2. 출애굽기 9장에서 이스라엘 자손의 생축이 죽지 않았음을 확인하는 데 가장 적합한 집계 함수는?**
a) `sum()`
b) `count()` (특정 조건 필터링 후)
c) `mean()`

**3. 왕의 신하의 'father_faith_level'의 평균적인 변화를 확인하는 데 사용되는 함수는?**
a) `count()`
b) `mean()`
c) `describe()`

**4. `DataFrame`에서 결측값을 제외한 유효한 데이터의 개수를 세는 함수는?**
a) `sum()`
b) `count()`
c) `len()`

**5. 다음 중 '집계'의 영적 의미로 가장 적절하지 않은 것은?**
a) 복잡한 삶 속에서 하나님의 핵심 메시지 요약
b) 인간의 반응(견고함, 믿음)을 수치적으로 이해
c) 모든 데이터를 개별적으로 상세히 분석하여 미시적 관점 유지

_(정답: 1-c, 2-b, 3-b, 4-b, 5-c)_

---

## 🎯 깊이 탐구 과제 (선택)

### 초급 과제

1.  **다른 재앙 데이터 집계**: 출애굽기의 다른 재앙들(예: 피 재앙, 개구리 재앙)에 대한 가상의 데이터를 만들고 `describe()`, `sum()` 등으로 집계 분석해보기
2.  **성경 인물 믿음 지수**: 성경에 나오는 다른 인물들(예: 아브라함, 다윗)의 믿음 여정을 데이터로 기록하고, `mean()` 함수를 사용하여 평균 믿음 지수를 계산해보기

### 중급 과제

1.  **파라오의 완악함 지수**: 출애굽기 전체에 걸쳐 파라오의 완악함이 어떻게 변화하는지 가상의 데이터를 만들고, `sum()` 또는 `mean()`으로 '완악함 지수'를 집계하여 시각화해보기
2.  **기도 응답률 분석**: 개인의 기도 제목과 응답 여부를 데이터로 기록하고, `count()` 함수를 사용하여 기도 응답률을 집계하고 분석해보기

### 고급 과제

1.  **영적 성장 대시보드**: 다양한 영적 활동(기도, 말씀, 봉사 등) 데이터를 수집하여 월별/분기별로 `sum()`, `mean()` 등을 활용한 대시보드를 만들고, 영적 성장의 추이를 시각화해보기
2.  **교회 출석률 및 헌금 분석**: 가상의 교회 데이터를 생성하여 출석률, 헌금액 등을 `describe()`, `sum()`, `mean()`으로 집계하고, 이를 통해 교회의 영적 활성도를 분석하는 보고서 작성해보기

---

## 🌟 다음 여정 예고

**Chapter 10: "흑암 중의 빛 — 그룹 연산"**

애굽 땅에 흑암 재앙이 임했을 때, 이스라엘 자손이 거하는 고센 땅에는 빛이 있었습니다. 데이터 분석에서도 전체 데이터 속에서 특정 기준(그룹)별로 데이터를 나누어 분석하는 '그룹 연산'은 혼돈 속에서 질서를 발견하고, 어둠 속에서 빛을 찾아내는 중요한 통찰을 제공합니다.

다음 장에서는:

-   **출애굽기 10장**: 아홉 번째 재앙 (흑암) → 전체 속의 구분
-   **요한복음 8:12**: "나는 세상의 빛이니" → 그룹별 빛의 발견
-   **pandas 기술**: `groupby()` 기본(집계/필터/변환), `agg()` 등

흑암 속에서도 빛이 있었듯이, 복잡한 데이터 속에서도 `groupby()`를 통해 의미 있는 그룹을 찾아내고, 그 안에서 하나님의 메시지를 발견할 것입니다.

---

## 🙏 한 줄 기도

"주님, 복잡한 세상 속에서 저의 마음이 견고해지지 않도록 지켜주시고, 모든 상황 속에서 주님의 메시지를 집계하고 요약하여 깨닫게 하소서. 예수님의 이름으로 기도합니다. 아멘."

---

**🎊 아홉 번째 광야 여정을 완주하신 것을 축하합니다!**

"내가 이번에는 모든 재앙을 너와 네 신하와 네 백성에게 내려..." (출애굽기 9:14)

여러분은 이제 데이터 속에서 하나님의 권능과 인간의 반응을 집계하고 요약하는 방법을 알게 되었습니다. 주님께서 주신 지혜로 모든 혼돈 속에서 질서를 발견하시길 기도합니다.

**다음 여정에서 만나요! 🌈**