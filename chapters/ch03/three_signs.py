# ch03_three_signs.py
"""
ì„¸ ê°€ì§€ í‘œì  - ê¶Œìœ„ì™€ ëŠ¥ë ¥ì˜ ì¦ê±°
"""

import pandas as pd
import numpy as np


def create_signs_matrix():
    """ì„¸ ê°€ì§€ í‘œì ì˜ ìƒì„¸ ë¶„ì„"""

    signs_detail = pd.DataFrame({
        'í‘œì ': ['ì§€íŒ¡ì´â†’ë±€', 'ì†â†’ë‚˜ë³‘', 'ë¬¼â†’í”¼'],
        'ì›ìƒíƒœ': ['ëª©ìì˜ ë„êµ¬', 'ê±´ê°•í•œ ì†', 'ë‚˜ì¼ê°• ë¬¼'],
        'ë³€í™˜ìƒíƒœ': ['ìœ„í˜‘ì ì¸ ë±€', 'ë‚˜ë³‘ ë“  ì†', 'í”¼'],
        'ë³µì›ì—¬ë¶€': ['ë³µì›ë¨', 'ë³µì›ë¨', 'ë³µì› ì•ˆë¨'],
        'ëŒ€ìƒ': ['ë°”ë¡œ/ìˆ ê°', 'ì´ìŠ¤ë¼ì—˜', 'ì• êµ½ ì „ì²´'],
        'ëª©ì ': ['ê¶Œìœ„ ì¦ëª…', 'ëŠ¥ë ¥ ì¦ëª…', 'ì‹¬íŒ ì˜ˆê³ '],
        'ìœ„í—˜ë„': [7, 5, 10],
        'ì˜í–¥ë²”ìœ„': ['ê°œì¸', 'ì§‘ë‹¨', 'êµ­ê°€'],
        'ì¬ì•™ì—°ê²°': ['í•´ë‹¹ì—†ìŒ', '6ì¬ì•™(ë…ì¢…)', '1ì¬ì•™(í”¼)']
    })

    print("ğŸ”® ì„¸ ê°€ì§€ í‘œì  ìƒì„¸ ë¶„ì„")
    print("=" * 60)
    print(signs_detail)

    return signs_detail


def analyze_sign_progression():
    """í‘œì ì˜ ì ì§„ì  ê°•í™” íŒ¨í„´"""

    # ê°•ë„ ë¶„ì„
    intensity = pd.Series([3, 5, 10],
                          index=['í‘œì 1', 'í‘œì 2', 'í‘œì 3'],
                          name='ê°•ë„')

    # ë²”ìœ„ ë¶„ì„
    scope = pd.Series([1, 2, 5],
                      index=['í‘œì 1', 'í‘œì 2', 'í‘œì 3'],
                      name='ë²”ìœ„')

    # ì¢…í•© ì˜í–¥ë ¥
    impact = intensity * scope
    impact.name = 'ì˜í–¥ë ¥'

    progression_df = pd.DataFrame({
        'ê°•ë„': intensity,
        'ë²”ìœ„': scope,
        'ì˜í–¥ë ¥': impact
    })

    print("\nğŸ“Š í‘œì ì˜ ì ì§„ì  ê°•í™”:")
    print(progression_df)
    print(f"\ní‰ê·  ì˜í–¥ë ¥: {impact.mean():.1f}")
    print(f"ì¦ê°€ìœ¨: {(impact.iloc[-1] / impact.iloc[0] - 1) * 100:.0f}%")

    return progression_df


def compare_exodus_john_signs():
    """ì¶œì• êµ½ê¸°ì™€ ìš”í•œë³µìŒ í‘œì  ë¹„êµ"""

    comparison = pd.DataFrame({
        'êµ¬ë¶„': ['ì²«í‘œì ', 'ëŒ€ìƒ', 'ë¬¼ì§ˆ', 'ëª©ì ', 'ë°˜ì‘'],
        'ëª¨ì„¸': ['ì§€íŒ¡ì´â†’ë±€', 'ìê¸°ìì‹ ', 'ëª©ìë„êµ¬', 'ì†Œëª…í™•ì¸', 'ë‘ë ¤ì›€â†’ìˆœì¢…'],
        'ì˜ˆìˆ˜': ['ë¬¼â†’í¬ë„ì£¼', 'í˜¼ì¸ì”ì¹˜', 'ì •ê²°ì˜ˆì‹ë¬¼', 'ì˜ê´‘ë‚˜íƒ€ëƒ„', 'ì œìë“¤ë¯¿ìŒ']
    })

    print("\nâœï¸ ëª¨ì„¸ì™€ ì˜ˆìˆ˜ì˜ ì²« í‘œì  ë¹„êµ:")
    print(comparison)

    # ìš”í•œë³µìŒ 7í‘œì 
    john_signs = pd.Series({
        'ë¬¼â†’í¬ë„ì£¼': 'ê°€ë‚˜',
        'ì™•ì˜ì‹ í•˜ì•„ë“¤': 'ê°€ë²„ë‚˜ì›€',
        '38ë…„ëœë³‘ì': 'ë² ë°ìŠ¤ë‹¤',
        'ì˜¤ë³‘ì´ì–´': 'ê°ˆë¦´ë¦¬',
        'ë¬¼ìœ„ë¥¼ê±·ì‹¬': 'ê°ˆë¦´ë¦¬ë°”ë‹¤',
        'ë§¹ì¸ì¹˜ìœ ': 'ì˜ˆë£¨ì‚´ë ˜',
        'ë‚˜ì‚¬ë¡œ': 'ë² ë‹¤ë‹ˆ'
    }, name='ì¥ì†Œ')

    print("\nğŸ“– ìš”í•œë³µìŒ 7ê°€ì§€ í‘œì :")
    for sign, place in john_signs.items():
        print(f"  {sign}: {place}")

    return comparison, john_signs


def simulate_transformation():
    """í‘œì ì˜ ë³€í™˜ ê³¼ì • ì‹œë®¬ë ˆì´ì…˜"""

    print("\nğŸ”„ ë³€í™˜ ì‹œë®¬ë ˆì´ì…˜:")
    print("-" * 40)

    # ì§€íŒ¡ì´ ë³€í™˜
    staff_states = pd.Series({
        't0_ì´ˆê¸°': 'ì§€íŒ¡ì´',
        't1_ë˜ì§': 'ë–¨ì–´ì§',
        't2_ë³€í™˜': 'ë±€',
        't3_ë„ë§': 'ëª¨ì„¸ë„ë§',
        't4_ëª…ë ¹': 'ê¼¬ë¦¬ë¥¼ì¡ìœ¼ë¼',
        't5_ë³µì›': 'ì§€íŒ¡ì´'
    })

    print("ì§€íŒ¡ì´ ë³€í™˜ ê³¼ì •:")
    for time, state in staff_states.items():
        print(f"  {time}: {state}")

    # ì† ë³€í™˜
    hand_transform = pd.DataFrame({
        'ì‹œê°„': ['t0', 't1', 't2', 't3'],
        'ë™ì‘': ['í’ˆì— ë„£ìŒ', 'êº¼ëƒ„', 'ë‹¤ì‹œ ë„£ìŒ', 'êº¼ëƒ„'],
        'ìƒíƒœ': ['ì •ìƒ', 'ë‚˜ë³‘', 'ë‚˜ë³‘', 'ì •ìƒ'],
        'ì˜ë¯¸': ['ì›ë˜ìƒíƒœ', 'ë¶€ì •', 'ì€í', 'íšŒë³µ']
    })

    print("\nâœ‹ ì† ë³€í™˜ ê³¼ì •:")
    print(hand_transform)

    return staff_states, hand_transform


def analyze_theological_meaning():
    """í‘œì ì˜ ì‹ í•™ì  ì˜ë¯¸ ë¶„ì„"""

    theology = pd.DataFrame({
        'í‘œì ': ['ì§€íŒ¡ì´', 'ì†', 'ë¬¼'],
        'êµ¬ì•½ë°°ê²½': ['ëª©ìì˜ ê¶Œìœ„', 'ì œì‚¬ì¥ ê²€ì¦', 'ìƒëª…ì˜ ê·¼ì›'],
        'ì‹ ì•½ì„±ì·¨': ['ì„ í•œ ëª©ì', 'ì •ê²°ì¼€ í•˜ì‹œëŠ” ì´', 'ìƒëª…ìˆ˜'],
        'ì¢…ë§ë¡ ì ì˜ë¯¸': ['ì² ì¥ ê¶Œì„¸', 'ê±°ë£©í•œ ë°±ì„±', 'ìƒëª…ê°•']
    })

    print("\nğŸ“œ í‘œì ì˜ ì‚¼ì¤‘ì  ì˜ë¯¸:")
    print(theology)

    return theology


def main():
    print("=" * 60)
    print("  ì„¸ ê°€ì§€ í‘œì  - í•˜ë‚˜ë‹˜ì˜ ëŠ¥ë ¥ ì¦ê±°")
    print("=" * 60)

    # ë¶„ì„ ì‹¤í–‰
    signs = create_signs_matrix()
    progression = analyze_sign_progression()
    comparison, john_signs = compare_exodus_john_signs()
    staff, hand = simulate_transformation()
    theology = analyze_theological_meaning()

    # ìš”ì•½
    print("\nğŸ’¡ í•µì‹¬ í†µì°°:")
    print("1. í‘œì ì€ ì ì§„ì ìœ¼ë¡œ ê°•í™”ëœë‹¤ (ê°œì¸â†’ì§‘ë‹¨â†’êµ­ê°€)")
    print("2. ê° í‘œì ì€ í•˜ë‚˜ë‹˜ì˜ ë‹¤ë¥¸ ì†ì„±ì„ ê³„ì‹œí•œë‹¤")
    print("3. ë³µì› ê°€ëŠ¥ì„±ì´ ì¤„ì–´ë“ ë‹¤ (ì™„ì „â†’ë¶€ë¶„â†’ë¶ˆê°€)")
    print("4. ëª¨ì„¸ì˜ í‘œì ì€ ì‹¬íŒ, ì˜ˆìˆ˜ì˜ í‘œì ì€ ì€í˜œ")


if __name__ == "__main__":
    main()