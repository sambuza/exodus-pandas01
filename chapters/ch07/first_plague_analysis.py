import pandas as pd
import numpy as np

def analyze_plague_severity():
    """ì¶œì• êµ½ê¸° 7ì¥ ì²« ì¬ì•™ì˜ ê°•ë„ ë¶„ì„: ì •ë ¬ëœ ì‹¬íŒ"""
    print("\nğŸŒŠ ì²« ì¬ì•™, ë‚˜ì¼ê°•ì˜ í”¼: ì •ë ¬ëœ ì‹¬íŒì˜ ì‹œì‘")
    print("=" * 50)

    plague_data = pd.DataFrame({
        'ì¬ì•™_ë²ˆí˜¸': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
        'ì¬ì•™_ì´ë¦„': ['í”¼', 'ê°œêµ¬ë¦¬', 'ì´', 'íŒŒë¦¬', 'ëŒë¦¼ë³‘', 'ë…ì¢…', 'ìš°ë°•', 'ë©”ëšœê¸°', 'í‘ì•”', 'ì¥ì ì£½ìŒ'],
        'ì˜í–¥_ë²”ìœ„': ['ë‚˜ì¼ê°•', 'ì• êµ½ ì „ì—­', 'ì• êµ½ ì „ì—­', 'ì• êµ½ ì „ì—­', 'ê°€ì¶•', 'ì• êµ½ì¸', 'ì• êµ½ ì „ì—­', 'ì• êµ½ ì „ì—­', 'ì• êµ½ ì „ì—­', 'ì• êµ½ ì „ì—­'],
        'í”¼í•´_ê°•ë„': [8, 6, 4, 7, 9, 8, 9.5, 9.2, 7.5, 10], # 1-10 ìŠ¤ì¼€ì¼
        'íŒŒë¼ì˜¤_ë°˜ì‘_ê°•ë„': [1, 2, 2, 3, 4, 4, 5, 6, 6, 7] # 1-10 ìŠ¤ì¼€ì¼, ê±°ë¶€ ê°•ë„
    })
    print(plague_data)

    # 'í”¼í•´_ê°•ë„'ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¬ì•™ì„ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
    sorted_by_severity = plague_data.sort_values(by='í”¼í•´_ê°•ë„', ascending=False)
    print("\nğŸ“ˆ í”¼í•´ ê°•ë„ ê¸°ì¤€ìœ¼ë¡œ ì¬ì•™ ì •ë ¬ (ë‚´ë¦¼ì°¨ìˆœ):")
    print(sorted_by_severity[['ì¬ì•™_ì´ë¦„', 'í”¼í•´_ê°•ë„']])

    # 'íŒŒë¼ì˜¤_ë°˜ì‘_ê°•ë„'ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬
    sorted_by_pharaoh_response = plague_data.sort_values(by='íŒŒë¼ì˜¤_ë°˜ì‘_ê°•ë„', ascending=True)
    print("\nâš–ï¸ íŒŒë¼ì˜¤ ë°˜ì‘ ê°•ë„ ê¸°ì¤€ìœ¼ë¡œ ì¬ì•™ ì •ë ¬ (ì˜¤ë¦„ì°¨ìˆœ):")
    print(sorted_by_pharaoh_response[['ì¬ì•™_ì´ë¦„', 'íŒŒë¼ì˜¤_ë°˜ì‘_ê°•ë„']])

    # 'í”¼í•´_ê°•ë„'ì— ë”°ë¥¸ ìˆœìœ„ ë§¤ê¸°ê¸°
    plague_data['í”¼í•´_ê°•ë„_ìˆœìœ„'] = plague_data['í”¼í•´_ê°•ë„'].rank(ascending=False, method='min')
    print("\nğŸ† í”¼í•´ ê°•ë„ ìˆœìœ„:")
    print(plague_data[['ì¬ì•™_ì´ë¦„', 'í”¼í•´_ê°•ë„', 'í”¼í•´_ê°•ë„_ìˆœìœ„']].sort_values(by='í”¼í•´_ê°•ë„_ìˆœìœ„'))

    return plague_data

def analyze_pharaoh_response_ranking():
    """ì¶œì• êµ½ê¸° 7ì¥ íŒŒë¼ì˜¤ì˜ ë°˜ì‘ ìˆœìœ„ ë¶„ì„: ê³ ì •ëœ ë§ˆìŒì˜ ìˆœìœ„"""
    print("\nğŸ—¿ íŒŒë¼ì˜¤ì˜ ê°•í…í•œ ë§ˆìŒ: ì¬ì•™ ì† ë°˜ì‘ ìˆœìœ„")
    print("=" * 50)

    pharaoh_response = pd.DataFrame({
        'ì¬ì•™_ì´ë¦„': ['í”¼', 'ê°œêµ¬ë¦¬', 'ì´', 'íŒŒë¦¬', 'ëŒë¦¼ë³‘', 'ë…ì¢…', 'ìš°ë°•', 'ë©”ëšœê¸°', 'í‘ì•”', 'ì¥ì ì£½ìŒ'],
        'ë§ˆìŒ_êµ³ê¸°_ì ìˆ˜': [1, 2, 2, 3, 4, 4, 5, 6, 6, 7], # 1-10 ìŠ¤ì¼€ì¼ (ì ìˆ˜ê°€ ë†’ì„ìˆ˜ë¡ ë” êµ³ì€ ë§ˆìŒ)
        'ê³ ë°±_ê°€ëŠ¥ì„±': [0.1, 0.2, 0.2, 0.3, 0.4, 0.4, 0.5, 0.6, 0.6, 0.7]
    })
    print(pharaoh_response)

    # 'ë§ˆìŒ_êµ³ê¸°_ì ìˆ˜'ì— ë”°ë¥¸ ìˆœìœ„ ë§¤ê¸°ê¸° (ì˜¤ë¦„ì°¨ìˆœ, ë™ì¼ ìˆœìœ„ëŠ” í‰ê· )
    pharaoh_response['êµ³ê¸°_ìˆœìœ„'] = pharaoh_response['ë§ˆìŒ_êµ³ê¸°_ì ìˆ˜'].rank(ascending=True, method='average')
    print("\nğŸ† íŒŒë¼ì˜¤ ë§ˆìŒ êµ³ê¸° ìˆœìœ„ (ì˜¤ë¦„ì°¨ìˆœ):")
    print(pharaoh_response[['ì¬ì•™_ì´ë¦„', 'ë§ˆìŒ_êµ³ê¸°_ì ìˆ˜', 'êµ³ê¸°_ìˆœìœ„']].sort_values(by='êµ³ê¸°_ìˆœìœ„'))

    # ê°€ì¥ ë§ˆìŒì´ êµ³ì€ 3ê°€ì§€ ì¬ì•™ ì‹œê¸° ì°¾ê¸° (`nlargest`)
    hardest_hearts = pharaoh_response.nlargest(3, 'ë§ˆìŒ_êµ³ê¸°_ì ìˆ˜')
    print("\nğŸš¨ ê°€ì¥ ë§ˆìŒì´ êµ³ì€ 3ê°€ì§€ ì¬ì•™ ì‹œê¸°:")
    print(hardest_hearts[['ì¬ì•™_ì´ë¦„', 'ë§ˆìŒ_êµ³ê¸°_ì ìˆ˜']])

    return pharaoh_response

def main():
    analyze_plague_severity()
    analyze_pharaoh_response_ranking()

if __name__ == "__main__":
    main()
