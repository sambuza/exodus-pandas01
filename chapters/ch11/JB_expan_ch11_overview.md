# Chapter 11: 유월절 — 병합과 연결의 방식

## 개요 (Overview)
이번 챕터에서는 Pandas의 `merge()`, `join()`, `concat()` 함수를 사용하여 서로 다른 데이터셋을 하나의 의미 있는 정보로 병합하고 연결하는 방법을 배웁니다. 출애굽기 11장의 열 번째 재앙 예고와 유월절 준비, 그리고 요한복음 6장의 오병이어 기적을 통해, 흩어진 정보들을 하나로 모아 전체적인 그림을 이해하고 더 깊은 통찰을 얻는 과정을 탐구합니다.

This chapter introduces Pandas' `merge()`, `join()`, and `concat()` functions to combine and connect different datasets into a single meaningful piece of information. Through the announcement of the tenth plague and Passover preparations in Exodus 11, and the miracle of feeding the five thousand in John 6, we will explore the process of gathering scattered information to understand the complete picture and gain deeper insights.

---

## 📜 성경 본문 깊이 묵상

### 출애굽기 11장: 열 번째 재앙 예고와 유월절 준비

출애굽기 11장은 열 번째 재앙인 장자의 죽음이 예고되고, 이스라엘 백성이 유월절을 준비하는 과정을 담고 있습니다. 이 두 사건은 애굽의 심판과 이스라엘의 구원이라는 서로 다른 측면을 가지고 있지만, 유월절 어린 양의 피라는 하나의 연결고리로 병합됩니다.

- **열 번째 재앙 예고:** 애굽의 모든 처음 난 것이 죽을 것이나, 이스라엘 자손에게는 아무런 해가 없을 것임 (출 11:4-7)
- **유월절 준비:** 각 가족이 어린 양을 잡아 그 피를 문설주와 인방에 바르고, 무교병과 쓴 나물을 먹음 (출 12:1-14)

이처럼 서로 다른 사건(재앙 예고, 유월절 규례)과 그에 따른 결과(애굽의 심판, 이스라엘의 구원)는 `merge()`나 `join()`과 같이 특정 키(유월절 어린 양의 피)를 통해 연결되어 하나의 완전한 구원 서사를 이룹니다. `concat()`은 여러 데이터 조각들을 단순히 이어 붙여 더 큰 데이터셋을 만드는 데 비유할 수 있습니다.

### 요한복음 6:4–14: 오병이어 기적

예수님께서 오천 명을 먹이신 오병이어 기적은 작은 보리떡 다섯 개와 물고기 두 마리라는 보잘것없는 자원들이 예수님의 손에서 놀랍게 증폭되어 수많은 사람들을 배불리 먹이고도 남은 조각이 열두 바구니에 가득 찬 사건입니다.

- **작은 자원:** 보리떡 다섯 개와 물고기 두 마리 (요 6:9)
- **수많은 사람:** 남자만 오천 명 (요 6:10)
- **놀라운 결과:** 모두 배불리 먹고 남은 조각이 열두 바구니에 가득 참 (요 6:11-13)

이 기적은 서로 다른 종류의 자원(떡, 물고기)과 사람들의 필요(배고픔)가 예수님의 능력 안에서 하나로 '병합'되고 '연결'되어 엄청난 결과를 만들어낸 것을 보여줍니다. `concat()`은 여러 사람들의 작은 양식들을 모아 하나의 큰 식사를 만든 것에 비유할 수 있으며, `merge()`와 `join()`은 자원과 필요를 연결하여 기적의 규모를 이해하는 데 사용될 수 있습니다.

---

## 🔍 숨겨진 질문 발견

**출애굽기에서 발견할 질문들:**

- 열 번째 재앙 예고와 유월절 규례라는 두 가지 사건을 어떤 '키'를 통해 병합하여 분석할 수 있을까?
- 애굽의 장자 데이터와 이스라엘 가족 데이터를 병합하여, 유월절 밤의 피해 상황을 어떻게 재구성할 수 있을까?
- 유월절 준비 과정(어린 양 선택, 피 바르기, 무교병 먹기)의 각 단계를 `concat()`으로 이어 붙여 전체적인 흐름을 파악할 수 있을까?

**요한복음에서 발견할 질문들:**

- 오병이어 기적에서 '자원' 데이터(떡, 물고기)와 '사람' 데이터(남자 오천 명)를 병합하여, 1인당 할당된 자원의 양을 어떻게 계산할 수 있을까?
- 기적 전후의 '자원' 데이터를 `concat()`하여, 예수님의 능력이 자원을 어떻게 증폭시켰는지 시각화할 수 있을까?
- 예수님의 말씀을 들은 사람들의 반응 데이터와 오병이어 기적에 참여한 사람들의 데이터를 병합하여, 말씀과 기적의 상호작용을 분석할 수 있을까?

이런 질문들은 데이터의 '병합과 연결'이라는 관점으로 성경 본문을 더 깊이 이해하는 데 도움을 줄 것이다.

---

## 📊 판다스로 성경 탐구하기

### 탐구 1: 유월절 사건 병합 분석 (merge, join)

```python
import pandas as pd
from .passover_preparation_data import PassoverPreparationDataGenerator

# 유월절 데이터 생성
data_gen = PassoverPreparationDataGenerator()
df_plague_announce, df_passover_rules = data_gen.generate_passover_data()

print("🔥 열 번째 재앙 예고 데이터:", df_plague_announce)
print("\n📜 유월절 규례 데이터:", df_passover_rules)

# 'event_id'를 키로 사용하여 두 데이터프레임 병합
print("\n--- 'event_id'를 키로 재앙 예고와 유월절 규례 병합 (Merge by 'event_id') ---")
merged_passover = pd.merge(df_plague_announce, df_passover_rules, on='event_id', how='inner')
print(merged_passover)

# 'event_type'을 인덱스로 설정하여 join
print("\n--- 'event_type'을 인덱스로 유월절 규례와 재앙 예고 조인 (Join by 'event_type' index) ---")
joined_passover = df_passover_rules.set_index('event_type').join(df_plague_announce.set_index('event_type'), lsuffix='_rule', rsuffix='_announce')
print(joined_passover)
```

### 탐구 2: 오병이어 기적 데이터 연결 분석 (concat)

```python
import pandas as pd
from .feeding_five_thousand_data import FeedingFiveThousandDataGenerator

# 오병이어 데이터 생성
data_gen = FeedingFiveThousandDataGenerator()
df_initial_resources, df_after_miracle = data_gen.generate_miracle_data()

print("🙏 초기 자원 데이터:", df_initial_resources)
print("\n✨ 기적 후 남은 조각 데이터:", df_after_miracle)

# 두 데이터프레임을 수직으로 연결 (concat)
print("\n--- 초기 자원과 기적 후 남은 조각 연결 (Concatenate Initial and After-Miracle Resources) ---")
concatenated_resources = pd.concat([df_initial_resources, df_after_miracle], ignore_index=True)
print(concatenated_resources)

# 다른 방식으로 연결 (예: 사람들의 필요 데이터와 자원 데이터 연결)
# (이 부분은 데이터 생성 시점에 따라 달라질 수 있으므로, 예시로만 제시)
# df_people_needs = pd.DataFrame({'resource_type': ['bread', 'fish'], 'people_count': [5000, 5000]})
# combined_data = pd.concat([df_initial_resources, df_people_needs], axis=1)
# print("\n--- 자원과 사람들의 필요 데이터 연결 (Concatenate Resources and People's Needs) ---")
# print(combined_data)
```

---

## ⭐ 놀라운 발견들

### 발견 1: `merge()`를 통한 구원 계획의 통합적 이해

유월절 재앙 예고와 규례 데이터를 `merge()`하면, 애굽의 심판과 이스라엘의 구원이 유월절 어린 양의 피라는 하나의 키로 어떻게 연결되는지 명확히 볼 수 있습니다. 이는 하나님의 구원 계획이 여러 사건들을 통해 유기적으로 연결되어 있음을 데이터적으로 보여주며, `merge()`가 파편화된 정보들을 통합하여 큰 그림을 이해하는 데 필수적인 도구임을 증명합니다.

### 발견 2: `concat()`을 통한 예수님 능력의 증폭 시각화

오병이어 기적의 초기 자원 데이터와 기적 후 남은 조각 데이터를 `concat()`하면, 예수님의 능력으로 인해 자원이 얼마나 놀랍게 증폭되었는지 시각적으로 확인할 수 있습니다. 작은 시작이 엄청난 결과로 이어지는 과정을 데이터의 연결을 통해 묵상할 수 있으며, `concat()`이 시간의 흐름이나 다른 관점에서 데이터를 이어 붙여 변화를 분석하는 데 유용함을 보여줍니다.

### 발견 3: `join()`을 통한 관계의 심층 분석

`join()`은 인덱스를 기반으로 데이터를 연결하여, 유월절 규례와 재앙 예고 사이의 관계를 더 심층적으로 분석할 수 있게 합니다. 이는 마치 성경 속 인물들의 관계나 사건들 간의 미묘한 연결고리를 찾아내는 것과 같습니다. `join()`을 통해 데이터 간의 숨겨진 관계를 발견하고, 하나님의 섭리를 더 깊이 이해할 수 있습니다.

---

## 🎨 블렌딩 모드: 출애굽 × 요한복음의 통합 통찰

|출애굽기 진리|요한복음 진리|판다스 도구|영적 발견|
|---|---|---|---|
|열 번째 재앙과 유월절 규례의 연결|오병이어 기적의 자원과 결과 연결|`merge()`, `join()`|하나님의 구원 계획은 유기적으로 연결되어 있음|
|애굽의 심판과 이스라엘의 구원|작은 자원으로 큰 무리를 먹이심|`concat()`|하나님의 능력은 부족함을 채우고 넘치게 함|
|유월절 어린 양의 피 = 구원의 키|예수님 = 생명의 떡, 구원의 키|`on` 파라미터|모든 구원의 중심은 예수 그리스도|
|흩어진 백성을 모으는 과정|흩어진 조각을 모으는 과정|데이터 통합|하나님은 흩어진 것을 모아 하나 되게 하심|
|하나님의 언약의 성취|예수님 말씀의 성취|데이터 일관성 확인|하나님의 말씀은 반드시 성취됨|

> **💎 블렌딩 결과**: `merge()`, `join()`, `concat()`은 파편화된 성경 이야기와 데이터 조각들을 하나로 모아 하나님의 구원 계획의 큰 그림을 이해하고, 예수님의 능력과 섭리를 더 깊이 탐구하는 강력한 도구입니다. 데이터의 연결을 통해 하나님의 일하심의 완전성을 발견할 수 있습니다.

---

## 🛠️ 광야 생존 프로젝트: 나의 삶의 데이터 병합 분석

**🎯 미션**: 내 삶의 다양한 데이터를 병합하고 연결하여 통합적인 통찰 얻기
**📊 사용 기술**: DataFrame 생성, `merge()`, `join()`, `concat()`
**🕊️ 복음 포인트**: "내가 곧 길이요 진리요 생명이니 나로 말미암지 않고는 아버지께로 올 자가 없느니라" (요한복음 14:6)

### Step 1: 나의 영적 활동과 감정 데이터 병합

```python
import pandas as pd

# 영적 활동 데이터
df_activities = pd.DataFrame({
    '날짜': pd.to_datetime(['2024-01-01', '2024-01-02', '2024-01-03']),
    '활동': ['기도', '말씀', '봉사'],
    '소요_시간_분': [30, 45, 60]
})

# 감정 상태 데이터
df_emotions = pd.DataFrame({
    '날짜': pd.to_datetime(['2024-01-01', '2024-01-02', '2024-01-03']),
    '감정': ['평안', '기쁨', '감사'],
    '강도': [5, 4, 5] # 1-5 스케일
})

print("🧬 나의 영적 활동 데이터:", df_activities)
print("\n💡 나의 감정 상태 데이터:", df_emotions)

# '날짜'를 키로 사용하여 두 데이터프레임 병합
print("\n--- 활동과 감정 데이터 병합 (Merge Activities and Emotions) ---")
merged_life_data = pd.merge(df_activities, df_emotions, on='날짜', how='inner')
print(merged_life_data)
```

### Step 2: 나의 기도 제목과 응답 데이터 연결

```python
# 기도 제목 데이터
df_requests = pd.DataFrame({
    '기도_ID': [1, 2, 3],
    '제목': ['가족 건강', '직장 문제', '영적 성장'],
    '요청일': pd.to_datetime(['2023-10-01', '2023-11-15', '2024-01-01'])
})

# 기도 응답 데이터
df_responses = pd.DataFrame({
    '기도_ID': [1, 3],
    '응답_내용': ['완치', '평안 주심'],
    '응답일': pd.to_datetime(['2024-02-01', '2024-03-10'])
})

print("🙏 나의 기도 제목 데이터:", df_requests)
print("\n✅ 나의 기도 응답 데이터:", df_responses)

# '기도_ID'를 키로 사용하여 기도 제목과 응답 데이터 병합 (left merge로 응답 없는 기도도 포함)
print("\n--- 기도 제목과 응답 데이터 병합 (Merge Prayer Requests and Responses) ---")
merged_prayer_data = pd.merge(df_requests, df_responses, on='기도_ID', how='left')
print(merged_prayer_data)
```

---

## 📱 3×10초 광야 루틴

### 🌅 아침 10초: 말씀 묵상

"내가 곧 길이요 진리요 생명이니 나로 말미암지 않고는 아버지께로 올 자가 없느니라." (요 14:6)
오늘도 예수님을 통해 하나님께 나아갑니다.

### ☀️ 점심 1분: 데이터 연결 기도

- 오늘 나의 삶에서 서로 연결되어 있는 사건들(예: 나의 행동과 그 결과, 나의 기도와 응답)을 떠올려 봅니다.
- 흩어진 정보들을 하나로 모아 주님의 뜻을 이해할 수 있도록 지혜를 구합니다.
- 모든 것이 예수님 안에서 연결되어 있음을 고백합니다.

### 🌙 저녁 2분: 데이터 기도일기

**오늘의 영적 데이터:**
- 오늘 나의 활동과 감정 데이터를 병합했을 때 발견한 새로운 통찰은?
- 나의 기도 제목과 응답 데이터를 연결했을 때, 하나님의 신실하심을 어떻게 볼 수 있었나?
- 주님, 모든 것을 연결하시는 분이심을 찬양합니다.

---

## ❓ FAQ & 체크리스트

### 깊이 있는 질문들

**Q1: `merge()`, `join()`, `concat()`의 주요 차이점은 무엇인가요?** A: `merge()`는 SQL의 JOIN과 유사하게 하나 이상의 키(열)를 기준으로 두 DataFrame을 병합합니다. `join()`은 기본적으로 인덱스를 기준으로 DataFrame을 결합하며, `merge()`의 특수한 경우로 볼 수 있습니다. `concat()`은 단순히 여러 DataFrame을 수직(행) 또는 수평(열)으로 이어 붙이는 함수입니다. `merge()`와 `join()`은 관계형 데이터베이스의 JOIN 개념에 가깝고, `concat()`은 스택(stack) 또는 어펜드(append) 개념에 가깝습니다.

**Q2: `merge()`에서 `how` 파라미터는 어떤 역할을 하나요?** A: `how` 파라미터는 병합 방식을 결정합니다. `inner` (교집합), `left` (왼쪽 DataFrame 기준), `right` (오른쪽 DataFrame 기준), `outer` (합집합) 등이 있습니다. 유월절 사건처럼 애굽과 이스라엘의 운명이 교차하는 지점은 `inner` merge로, 이스라엘의 관점에서 모든 사건을 보고 싶다면 `left` merge로 비유할 수 있습니다.

**Q3: 오병이어 기적에서 `concat()`을 사용하면 어떤 통찰을 얻을 수 있나요?** A: 기적 전의 초기 자원 데이터와 기적 후 남은 조각 데이터를 `concat()`하면, 예수님의 능력으로 인해 자원이 얼마나 놀랍게 증폭되었는지 한눈에 비교하고 시각화할 수 있습니다. 이는 작은 시작이 엄청난 결과로 이어지는 과정을 데이터의 연결을 통해 묵상하게 합니다.

**Q4: 성경 속 인물들의 관계를 `merge()`로 분석할 수 있을까요?** A: 네, 가능합니다. 예를 들어, 인물 정보 DataFrame과 관계 정보 DataFrame(누구의 아들, 누구의 형제 등)을 만들고, 공통된 인물 ID를 키로 `merge()`하면 복잡한 족보나 관계도를 데이터적으로 재구성할 수 있습니다. 이는 성경 속 관계의 중요성을 데이터로 이해하는 데 도움을 줍니다.

**Q5: 데이터 병합 시 발생할 수 있는 문제점은 무엇이며, 어떻게 해결할 수 있나요?** A: 주요 문제점으로는 키 불일치(key mismatch), 중복된 키(duplicate keys), 데이터 타입 불일치(data type mismatch) 등이 있습니다. `how` 파라미터를 적절히 사용하고, `indicator=True` 옵션으로 병합 출처를 확인하며, `validate` 파라미터로 키의 유일성을 검증하는 등의 방법으로 해결할 수 있습니다.

### ✅ 체크리스트

**성경 이해 체크:**

- [ ] 출애굽기 11장의 열 번째 재앙 예고와 유월절 준비 과정 이해
- [ ] 요한복음 6장의 오병이어 기적의 의미와 자원 증폭 과정 파악
- [ ] 유월절과 오병이어 기적 속에서 하나님의 구원 계획과 예수님의 능력을 이해

**DataFrame 기초 체크:**

- [ ] `pd.merge()` 함수를 사용하여 두 DataFrame 병합 성공
- [ ] `pd.join()` 함수를 사용하여 인덱스 기반 DataFrame 결합 성공
- [ ] `pd.concat()` 함수를 사용하여 DataFrame 이어 붙이기 성공
- [ ] `how` 파라미터(inner, left, right, outer)의 역할 이해

**영적 적용 체크:**

- [ ] 내 삶의 다양한 데이터를 병합하고 연결하여 통합적인 통찰 얻기 시도 완료
- [ ] 나의 기도 제목과 응답 데이터를 연결하여 하나님의 신실하심 확인 시도 완료
- [ ] 데이터 병합 원리를 통해 삶의 파편화된 정보들을 통합하여 주님의 뜻 발견 고민

**발견 기록 체크:**

- [ ] `merge()`를 통한 구원 계획의 통합적 이해 확인
- [ ] `concat()`을 통한 예수님 능력의 증폭 시각화 확인
- [ ] `join()`을 통한 관계의 심층 분석 통찰

---

## 🧠 미니 퀴즈

**1. 두 DataFrame을 하나 이상의 키(열)를 기준으로 병합하는 함수는?**
a) `pd.concat()`
b) `pd.merge()`
c) `pd.join()`

**2. `DataFrame`을 단순히 수직(행) 또는 수평(열)으로 이어 붙이는 함수는?**
a) `pd.merge()`
b) `pd.join()`
c) `pd.concat()`

**3. 유월절 사건처럼 애굽의 심판과 이스라엘의 구원이라는 두 가지 사건을 하나의 키(어린 양의 피)로 연결하는 데 가장 적합한 `merge`의 `how` 파라미터는?**
a) `left`
b) `right`
c) `inner`

**4. 오병이어 기적에서 초기 자원 데이터와 기적 후 남은 조각 데이터를 시간의 흐름에 따라 이어 붙여 변화를 분석하는 데 가장 적합한 함수는?**
a) `pd.merge()`
b) `pd.join()`
c) `pd.concat()`

**5. 데이터 병합과 연결의 영적 의미로 가장 적절하지 않은 것은?**
a) 파편화된 정보들을 통합하여 하나님의 큰 그림 이해
b) 서로 다른 사건들 속에서 하나님의 유기적인 구원 계획 발견
c) 데이터 간의 관계를 무시하고 각 데이터를 독립적으로 분석

_(정답: 1-b, 2-c, 3-c, 4-c, 5-c)_

---

## 🎯 깊이 탐구 과제 (선택)

### 초급 과제

1.  **성경 인물 관계도 병합**: 성경 인물 데이터(이름, 출생지)와 관계 데이터(부모-자녀, 형제)를 만들고 `merge()`를 사용하여 인물 관계도를 재구성해보기
2.  **성경 구절 연결**: 특정 주제(예: 사랑, 믿음)에 대한 여러 성경 구절 데이터를 `concat()`하여 하나의 큰 데이터셋으로 만들어보기

### 중급 과제

1.  **유월절 사건 시계열 병합**: 열 번째 재앙 예고, 유월절 규례, 장자의 죽음 사건 데이터를 시간 순서대로 `merge()` 또는 `concat()`하여 유월절 밤의 상세한 시계열 데이터를 구성하고 분석해보기
2.  **오병이어 기적 자원 분배 분석**: 오병이어 기적의 초기 자원, 사람 수, 남은 조각 데이터를 `merge()`하여 1인당 초기 자원량과 기적 후 1인당 분배량을 계산하고 비교해보기

### 고급 과제

1.  **영적 성장 지표 통합 분석**: 개인의 영적 활동 데이터, 감정 상태 데이터, 기도 응답 데이터를 `merge()`와 `join()`을 사용하여 통합하고, 이를 바탕으로 영적 성장 지표를 개발하여 분석 대시보드 만들기
2.  **교회 공동체 데이터베이스 구축**: 가상의 교회 구성원 데이터, 봉사 활동 데이터, 헌금 데이터를 `merge()`와 `join()`을 사용하여 관계형 데이터베이스처럼 구축하고, 이를 통해 공동체의 다양한 측면을 분석하는 보고서 작성해보기

---

## 🌟 다음 여정 예고

**Chapter 12: "홍해를 건너며 — 중복과 고유값"**

이스라엘 백성이 홍해를 건너 광야로 들어섰을 때, 그들은 애굽의 속박에서 벗어나 새로운 정체성을 얻었습니다. 데이터 분석에서도 중복된 값들을 제거하고 고유한 값들을 찾아내는 것은 데이터의 '진정한 정체성'을 발견하고 불필요한 노이즈를 제거하는 중요한 과정입니다.

다음 장에서는:

-   **출애굽기 12장**: 홍해를 건너 광야로 → 애굽의 중복된 우상에서 벗어남
-   **요한복음 6:16–21**: 물 위를 걸으신 예수님 → 세상의 중복된 두려움을 이기심
-   **pandas 기술**: `duplicated()`, `drop_duplicates()`, `unique()`, `nunique()` 등

홍해를 건너 새로운 시작을 하듯이, 데이터 속 중복을 제거하고 고유한 가치를 찾아내어 하나님의 진정한 메시지를 발견할 것입니다.

---

## 🙏 한 줄 기도

"주님, 유월절 어린 양의 피로 저희를 구원하시고, 오병이어의 기적으로 저희의 필요를 채우시니 감사합니다.
저의 삶의 흩어진 조각들을 주님 안에서 병합하고 연결하여, 주님의 크신 계획을 온전히 이해하게 하소서.
예수님의 이름으로 기도합니다. 아멘."

---

**🎊 열한 번째 광야 여정을 완주하신 것을 축하합니다!**

"내가 그 밤에 애굽 땅에 두루 다니며 사람이나 짐승을 무론하고 애굽 가운데 처음 난 것을 다 치고 애굽의 모든 신에게 벌을 내리리라 나는 여호와로라" (출애굽기 12:12)

여러분은 이제 데이터 속에서 `merge()`, `join()`, `concat()`을 통해 파편화된 정보들을 하나로 모아 하나님의 구원 계획의 큰 그림을 이해하는 방법을 알게 되었습니다. 주님께서 주신 지혜로 모든 연결 속에서 하나님의 섭리를 발견하시길 기도합니다.

**다음 여정에서 만나요! 🌈**
