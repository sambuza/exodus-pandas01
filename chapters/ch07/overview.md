# Chapter 07. 첫 재앙의 시작 — 정렬과 순위

## 📖 학습 목표

이 챕터에서는 **정렬(Sorting)**과 **순위 매기기(Ranking)**의 개념을 익히고, `pandas`를 활용하여 데이터를 효과적으로 구조화하고 우선순위를 파악하는 방법을 배웁니다. 출애굽기 7장의 첫 재앙과 요한복음 3장 16-21절의 영적 순위 개념을 통해 데이터의 질서를 이해하고, 혼돈 속에서 의미를 찾아내는 통찰력을 기릅니다.

## 💡 핵심 질문

*   `pandas`에서 데이터를 특정 기준으로 정렬하는 방법은 무엇인가요?
*   다양한 조건에 따라 데이터에 순위를 매기는 방법은 무엇인가요?
*   성경적 맥락에서 정렬과 순위의 의미를 데이터 분석에 어떻게 적용할 수 있을까요?

## 🚀 워밍업: 첫 재앙과 데이터의 순서

나일강이 피로 변하는 첫 재앙은 단순한 사건이 아니라, 하나님의 심판의 질서와 강도를 보여줍니다. 이처럼 데이터도 특정 기준에 따라 정렬되고 순위가 매겨질 때 비로소 의미 있는 패턴과 우선순위를 드러냅니다.

## 📊 핵심 Pandas 기술

*   **`sort_values()`**: DataFrame이나 Series를 하나 이상의 열 값에 따라 정렬합니다. `ascending` 파라미터로 오름차순/내림차순을 지정할 수 있습니다.
*   **`sort_index()`**: DataFrame이나 Series를 인덱스 값에 따라 정렬합니다.
*   **`rank()`**: 데이터의 각 값에 순위를 부여합니다. `method` 파라미터(예: `'average'`, `'min'`, `'max'`, `'first'`, `'dense'`)를 통해 동일 값 처리 방식을 지정할 수 있습니다.
*   **`nlargest()` / `nsmallest()`**: Series나 DataFrame에서 가장 크거나 작은 `n`개의 값을 효율적으로 찾습니다.

## 🔗 성경적 맥락과 데이터 통찰

### 🗺️ 출애굽기 7장: 나일강의 피 재앙과 파라오의 강퍅함 (Sorting & Ranking by Severity)

첫 재앙은 나일강이 피로 변하는 사건이었습니다. 이 재앙의 강도와 파라오의 반응은 점진적으로 나타나며, 각각의 재앙은 나름의 심각도와 파라오의 마음을 굳게 하는 정도를 가집니다.

*   **재앙의 강도 정렬**: 각 재앙이 애굽에 미친 피해의 강도를 숫자로 표현하고, 이를 기준으로 재앙들을 정렬해 가장 심각했던 재앙과 덜 심각했던 재앙의 순서를 파악할 수 있습니다. 이는 `sort_values()`를 사용하여 특정 열(예: 피해_강도)을 기준으로 DataFrame을 정렬하는 것과 같습니다.
*   **파라오의 강퍅함 순위**: 파라오가 각 재앙에 어떻게 반응했는지(예: 얼마나 빨리 마음이 굳어졌는지)를 점수화하여 순위를 매길 수 있습니다. 이는 `rank()` 함수를 사용하여 파라오의 고집스러운 마음 상태를 수치화하고 순위를 부여하는 것과 유사합니다. 가장 강퍅했던 시기를 `nlargest()`로 찾아낼 수도 있습니다.

### 💡 요한복음 3:16–21: 빛과 어둠, 행위에 따른 심판 (Spiritual Sorting & Ranking)

요한복음 3장은 하나님이 세상을 이처럼 사랑하사 독생자를 주셨다는 메시지와 함께, 믿는 자와 믿지 않는 자, 빛 가운데 행하는 자와 어둠 가운데 행하는 자를 구분하고 심판하는 기준을 제시합니다.

*   **영적 가치의 정렬**: 빛을 사랑하고 진리를 행하는 행위와 어둠을 사랑하고 악을 행하는 행위를 영적인 가치로 점수화하여 정렬할 수 있습니다. 이는 우리의 삶에서 무엇이 더 중요한 영적 우선순위를 가지는지 `sort_values()`로 파악하는 것과 같습니다.
*   **구원/심판의 순위**: 예수님을 믿는 행위는 영생을 얻게 하지만, 불신과 악행은 심판을 받게 합니다. 이러한 영적 결과에 따라 행위들에 순위를 매길 수 있습니다. `rank()` 함수는 영적 결과에 따른 순위를 매기는 데 유용하며, `nlargest()`와 `nsmallest()`는 가장 높은 구원의 가능성을 가진 행위나 가장 낮은 가능성을 가진 행위를 찾아낼 수 있습니다.

## 🤝 블렌딩 모드: 출애굽 × 요한복음 × 개인 여정

두 성경 본문은 혼돈 속에서 질서를 세우시는 하나님, 그리고 그 질서 안에서 행위의 가치와 결과를 명확히 구분하는 심판의 원리를 보여줍니다. 데이터의 정렬과 순위 매기기는 이러한 성경적 통찰을 실생활의 데이터에 적용하는 강력한 도구입니다.

*   **세상의 재앙 속 질서**: 복잡하고 혼란스러운 세상의 데이터(정보, 뉴스, 사건) 속에서 `sort_values()`를 통해 중요도를 정렬하고, `rank()`를 통해 우선순위를 매김으로써 하나님의 시선으로 현상을 분석하고 이해할 수 있습니다.
*   **삶의 우선순위 재정렬**: 나의 시간, 자원, 에너지 사용에 대한 데이터를 수집하고, `sort_values()`와 `rank()`를 사용하여 영적 성장, 관계, 사명 등 핵심 가치에 따라 우선순위를 재정렬해볼 수 있습니다. 무엇이 하나님 앞에서 가장 중요한지, 무엇이 가장 시급한지를 데이터 기반으로 분석하고 결정하는 연습입니다.
*   **영적 분별력**: `nlargest()`와 `nsmallest()`를 통해 가장 시치급하고 영적으로 중요한 것과 그렇지 않은 것을 빠르게 식별하여, 지혜로운 선택을 돕는 도구로 활용할 수 있습니다.

## 🛠️ 개인 프로젝트: 나의 삶 정렬하기

1.  **데이터 수집**: 일주일 동안 당신이 하는 활동들을 기록해보세요 (예: 기도 시간, 말씀 묵상 시간, 봉사 활동, 업무 시간, 휴식 시간, 미디어 소비 시간 등).
2.  **데이터프레임 생성**: 기록한 활동 데이터를 `pandas` DataFrame으로 만드세요. `'활동_내용'`, `'소요_시간'`, `'영적_유익_점수' (1-10)`, `'세속적_유익_점수' (1-10)` 등의 열을 포함할 수 있습니다.
3.  **영적 우선순위 정렬**: `'영적_유익_점수'`를 기준으로 활동들을 내림차순 정렬하고 출력하세요.
4.  **효율성 순위 매기기**: `'소요_시간'` 대비 `'영적_유익_점수'`의 비율을 계산하여 새로운 열을 만들고, 이 비율에 따라 순위를 매겨 출력하세요. (예: `(영적_유익_점수 / 소요_시간)`).
5.  **성찰**: 이 분석 결과를 통해 당신의 삶에서 영적으로 가장 효율적인 활동과 비효율적인 활동은 무엇이며, 시간을 어떻게 재배치해야 할지 고민해보세요.

## ❓ 자주 묻는 질문 (FAQ)

*   **`sort_values()`와 `sort_index()`의 주요 차이점은 무엇인가요?**
    *   `sort_values()`는 DataFrame의 특정 열(컬럼)의 값을 기준으로 정렬하고, `sort_index()`는 DataFrame의 인덱스(행 레이블)를 기준으로 정렬합니다.
*   **`rank()` 함수에서 `method` 파라미터는 왜 중요한가요?**
    *   `method` 파라미터는 동일한 값을 가진 항목들의 순위를 어떻게 처리할지를 결정합니다. 예를 들어, `'average'`는 동일 순위 값의 평균을, `'min'`은 가장 낮은 순위를, `'first'`는 나타난 순서대로 순위를 부여합니다. 데이터의 특성과 분석 목적에 따라 적절한 `method`를 선택하는 것이 중요합니다.
*   **`nlargest()`와 `nsmallest()`는 언제 사용해야 하나요?**
    *   전체 데이터를 정렬할 필요 없이, 가장 크거나 작은 상위/하위 `n`개의 값만 필요할 때 매우 효율적입니다. 대규모 데이터셋에서 성능상 이점이 있습니다.

## 🧠 미니 퀴즈

1.  다음 DataFrame `df = pd.DataFrame({'A': [1, 3, 2], 'B': ['c', 'a', 'b']})`를 `'B'` 열을 기준으로 오름차순 정렬하는 코드는?
    a) `df.sort_index(by='B')`
    b) `df.sort_values(by='B')`
    c) `df.rank(by='B')`
    d) `df.nlargest(by='B')`
2.  `rank(method='first')`는 동일한 값을 가진 항목에 대해 어떤 순위를 부여하나요?
    a) 평균 순위
    b) 가장 낮은 순위
    c) 가장 높은 순위
    d) 데이터에 먼저 나타난 순서대로 순위
3.  DataFrame `df`에서 `'Score'` 열의 가장 큰 5개 값을 찾으려면 어떤 함수를 사용해야 할까요?
    a) `df.sort_values(by='Score').head(5)`
    b) `df.nlargest(5, 'Score')`
    c) `df.rank(5, 'Score')`
    d) `df.where(df['Score'] in df.nlargest(5, 'Score'))`

---

## 🌟 다음 여정 예고

### **Chapter 08: 재앙 속의 구분 — 고센과 마스킹**

*   **테마**: 하나님의 구별된 은혜와 데이터 마스킹
*   **성경**:
    *   **출애굽기 8장**: 고센 땅에 임하지 않는 재앙
    *   **요한복음 4:1–15**: 사마리아 여인과 생수 (영적 목마름의 발견과 채워짐)
*   **핵심 기술**: `df.mask()`, `df.where()`, `df.query()`
*   **내용**: 출애굽기 8장에서 이스라엘 백성이 거하는 고센 땅만 재앙에서 면제되듯이, 데이터 분석에서도 특정 조건에 따라 데이터를 '구분'하고 '마스킹(mask)'하는 것은 중요한 정보를 보호하고, 필요한 데이터에만 집중하는 데 필수적인 기술입니다. 다음 장에서는 데이터를 효과적으로 구분하고 마스킹하는 법을 배워, 혼돈 속에서도 하나님의 구별된 은혜를 발견할 것입니다.

### **Chapter 09: 애굽의 재산과 그룹화 — 집계와 변환**

*   **테마**: 하나님의 소유와 데이터 그룹화
*   **성경**:
    *   **출애굽기 9장**: 가축 재앙과 애굽의 재산 피해
    *   **요한복음 4:43–54**: 왕의 신하의 아들을 고치시다 (믿음의 종류와 대상)
*   **핵심 기술**: `groupby()`, `agg()`, `transform()`, `pivot_table()`
*   **내용**: 애굽의 재앙은 애굽의 재산에 큰 타격을 주었지만, 하나님의 소유인 이스라엘 백성의 재산은 보호되었습니다. 데이터 분석에서 `groupby()`는 특정 기준에 따라 데이터를 그룹으로 묶고, 각 그룹에 대한 `agg()` 집계나 `transform()` 변환을 적용하여 새로운 통찰을 얻는 강력한 기술입니다. 다음 장에서는 데이터를 그룹화하고 집계하며 변환하는 방법을 배워, 데이터 속에서 하나님의 주권적인 소유와 보호의 원리를 발견할 것입니다.

---

**정답:**
1.  b) `df.sort_values(by='B')`
2.  d) 데이터에 먼저 나타난 순서대로 순위
3.  b) `df.nlargest(5, 'Score')`
