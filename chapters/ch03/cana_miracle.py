# ch03_cana_miracle.py
"""
ê°€ë‚˜ì˜ í˜¼ì¸ì”ì¹˜ - ì²« ë²ˆì§¸ í‘œì 
"""

import pandas as pd
import numpy as np


def analyze_water_jars():
    """6ê°œ í•­ì•„ë¦¬ ë¶„ì„"""

    # í•­ì•„ë¦¬ ì •ë³´
    jars_df = pd.DataFrame({
        'í•­ì•„ë¦¬': [f'í•­ì•„ë¦¬{i + 1}' for i in range(6)],
        'ìš©ëŸ‰_ë¦¬í„°': [40] * 6,
        'ìš©ë„': ['ì •ê²°ì˜ˆì‹'] * 6,
        'ì¬ì§ˆ': ['ëŒ'] * 6,
        'ìƒíƒœ': ['ë¹„ì–´ìˆìŒ'] * 6
    })

    print("ğŸ’§ 6ê°œ ëŒ í•­ì•„ë¦¬ ë¶„ì„")
    print("=" * 50)
    print(jars_df)

    total_capacity = jars_df['ìš©ëŸ‰_ë¦¬í„°'].sum()
    print(f"\nì´ ìš©ëŸ‰: {total_capacity} ë¦¬í„°")
    print(f"í¬ë„ì£¼ ë³‘ í™˜ì‚°: ì•½ {total_capacity / 0.75:.0f} ë³‘")

    # ìƒì§•ì  ì˜ë¯¸
    symbolism = pd.Series({
        '6ì˜ ì˜ë¯¸': 'ë¶ˆì™„ì „ìˆ˜ (7-1)',
        'ëŒì˜ ì˜ë¯¸': 'ìœ¨ë²• (ëŒíŒ)',
        'ë¬¼ì˜ ì˜ë¯¸': 'ì •ê²° ì˜ì‹',
        'í¬ë„ì£¼ ì˜ë¯¸': 'ìƒˆ ì–¸ì•½ì˜ ê¸°ì¨'
    })

    print("\nğŸ“– ìƒì§•ì  ì˜ë¯¸:")
    for key, value in symbolism.items():
        print(f"  {key}: {value}")

    return jars_df, symbolism


def analyze_transformation_process():
    """ë¬¼ì´ í¬ë„ì£¼ë¡œ ë³€í•˜ëŠ” ê³¼ì •"""

    process = pd.DataFrame({
        'ë‹¨ê³„': [1, 2, 3, 4, 5],
        'ì‹œê°„': ['í˜¼ì¸ì”ì¹˜', 'í¬ë„ì£¼ë–¨ì–´ì§', 'ë§ˆë¦¬ì•„ìš”ì²­', 'ë¬¼ì±„ì›€', 'ë– ì„œê°€ì ¸ê°'],
        'í–‰ìœ„ì': ['ì†ë‹˜ë“¤', 'í•˜ì¸ë“¤', 'ë§ˆë¦¬ì•„', 'í•˜ì¸ë“¤', 'í•˜ì¸ë“¤'],
        'ì˜ˆìˆ˜ì˜_ë§ì”€': ['-', '-', 'ë‚˜ì™€ ë¬´ìŠ¨ ìƒê´€', 'í•­ì•„ë¦¬ì— ë¬¼ì„ ì±„ìš°ë¼', 'ë– ì„œ ì—°íšŒì¥ì—ê²Œ ê°–ë‹¤ì£¼ë¼'],
        'ê²°ê³¼': ['ì¶•ì œì§„í–‰', 'ìœ„ê¸°ë°œìƒ', 'ë¯¿ìŒí‘œí˜„', 'ìˆœì¢…', 'ê¸°ì í™•ì¸']
    })

    print("\nğŸ· ë³€í™˜ ê³¼ì • ë¶„ì„:")
    print(process)

    # í’ˆì§ˆ ë³€í™”
    quality = pd.Series({
        'ë¬¼': 0,
        'ì¼ë°˜í¬ë„ì£¼': 50,
        'ì¢‹ì€í¬ë„ì£¼': 75,
        'ìµœìƒê¸‰í¬ë„ì£¼': 100
    })

    print("\nğŸ“Š í’ˆì§ˆ ì§€ìˆ˜:")
    print(quality)
    print(f"í’ˆì§ˆ í–¥ìƒ: {quality.iloc[-1] - quality.iloc[0]} í¬ì¸íŠ¸")

    return process, quality


def compare_water_blood_transformation():
    """ë¬¼ì˜ ë³€í™˜: ì¶œì• êµ½ vs ê°€ë‚˜"""

    comparison = pd.DataFrame({
        'í•­ëª©': ['ì¥ì†Œ', 'ì‹œê¸°', 'ë¬¼ì§ˆë³€í™”', 'ëª©ì ', 'ëŒ€ìƒ', 'ë©”ì‹œì§€'],
        'ì¶œì• êµ½_ë¬¼â†’í”¼': ['ë‚˜ì¼ê°•', 'ì¬ì•™ì‹œì‘', 'ë¬¼â†’í”¼', 'ì‹¬íŒ', 'ì• êµ½ì¸', 'ì£½ìŒê³¼ ì‹¬íŒ'],
        'ê°€ë‚˜_ë¬¼â†’í¬ë„ì£¼': ['í˜¼ì¸ì”ì¹˜', 'ì‚¬ì—­ì‹œì‘', 'ë¬¼â†’í¬ë„ì£¼', 'ì¶•ë³µ', 'ì œìë“¤', 'ìƒëª…ê³¼ ê¸°ì¨']
    })

    print("\nâš–ï¸ ë¬¼ ë³€í™˜ ë¹„êµ:")
    print(comparison.set_index('í•­ëª©'))

    return comparison


def analyze_wedding_context():
    """í˜¼ì¸ì”ì¹˜ì˜ ë¬¸í™”ì  ë°°ê²½"""

    cultural_context = pd.DataFrame({
        'ìš”ì†Œ': ['ê¸°ê°„', 'ì¤‘ìš”ì„±', 'í¬ë„ì£¼ì—­í• ', 'ë¶€ì¡±ì˜ë¯¸', 'í•´ê²°ì±…'],
        'ì„¤ëª…': [
            'ë³´í†µ 7ì¼ê°„ ì§€ì†',
            'ê³µë™ì²´ ìµœëŒ€ ì¶•ì œ',
            'ê¸°ì¨ê³¼ ì¶•ë³µì˜ ìƒì§•',
            'ê°€ë¬¸ì˜ ìˆ˜ì¹˜',
            'ì˜ˆìˆ˜ì˜ ê°œì…'
        ]
    })

    print("\nğŸŠ í˜¼ì¸ì”ì¹˜ ë¬¸í™”ì  ë°°ê²½:")
    print(cultural_context)

    # ì‹œê°„ëŒ€ë³„ í¬ë„ì£¼ ì†Œë¹„ íŒ¨í„´ (ê°€ìƒ)
    consumption = pd.Series({
        'ì²«ì§¸ë‚ ': 100,
        'ë‘˜ì§¸ë‚ ': 80,
        'ì…‹ì§¸ë‚ ': 60,
        'ë„·ì§¸ë‚ ': 40,
        'ë‹¤ì„¯ì§¸ë‚ ': 30,
        'ì—¬ì„¯ì§¸ë‚ ': 20,
        'ì¼ê³±ì§¸ë‚ ': 10
    })

    print("\nğŸ“‰ ì¼ë°˜ì  í¬ë„ì£¼ ì†Œë¹„ íŒ¨í„´:")
    print(consumption)

    return cultural_context, consumption


def analyze_disciples_faith():
    """ì œìë“¤ì˜ ë¯¿ìŒ ì„±ì¥"""

    faith_growth = pd.DataFrame({
        'ì‚¬ê±´': ['ë¶€ë¦„ë°›ìŒ', 'ê°€ë‚˜í‘œì ', 'ì„±ì „ì²­ê²°', 'ì‚¬ë§ˆë¦¬ì•„', 'ì˜¤ë³‘ì´ì–´', 'ê³ ë°±'],
        'ë¯¿ìŒìˆ˜ì¤€': [20, 40, 50, 60, 75, 90],
        'í•µì‹¬ê¹¨ë‹¬ìŒ': [
            'ë©”ì‹œì•„ ë§Œë‚¨',
            'ì˜ê´‘ ëª©ê²©',
            'ê¶Œìœ„ í™•ì¸',
            'êµ¬ì›ì˜ ë³´í¸ì„±',
            'ëŠ¥ë ¥ ì²´í—˜',
            'ê·¸ë¦¬ìŠ¤ë„ ê³ ë°±'
        ]
    })

    print("\nğŸ“ˆ ì œìë“¤ì˜ ë¯¿ìŒ ì„±ì¥:")
    print(faith_growth)

    # ë¯¿ìŒ ì„±ì¥ë¥ 
    growth_rate = faith_growth['ë¯¿ìŒìˆ˜ì¤€'].pct_change() * 100
    faith_growth['ì„±ì¥ë¥ %'] = growth_rate.fillna(0).round(1)

    print("\në¯¿ìŒ ì„±ì¥ë¥ :")
    print(faith_growth[['ì‚¬ê±´', 'ë¯¿ìŒìˆ˜ì¤€', 'ì„±ì¥ë¥ %']])

    return faith_growth


def main():
    print("=" * 60)
    print("  ê°€ë‚˜ì˜ í˜¼ì¸ì”ì¹˜ - ì˜ê´‘ì˜ ì‹œì‘")
    print("=" * 60)

    # ë¶„ì„ ì‹¤í–‰
    jars, symbolism = analyze_water_jars()
    process, quality = analyze_transformation_process()
    comparison = compare_water_blood_transformation()
    context, consumption = analyze_wedding_context()
    faith = analyze_disciples_faith()

    # í•µì‹¬ ë©”ì‹œì§€
    print("\nâœ¨ í•µì‹¬ ë©”ì‹œì§€:")
    print("1. ì²« í‘œì ì´ í˜¼ì¸ì”ì¹˜ = ë©”ì‹œì•„ ì‹œëŒ€ëŠ” í˜¼ì¸ì”ì¹˜")
    print("2. ìœ¨ë²•(ëŒí•­ì•„ë¦¬+ì •ê²°ìˆ˜)ì—ì„œ ì€í˜œ(í¬ë„ì£¼)ë¡œ")
    print("3. ìµœìƒí’ˆ í¬ë„ì£¼ = ë³µìŒì€ ìœ¨ë²•ë³´ë‹¤ ìš°ì›”")
    print("4. 'ë‚˜ì˜ ë•Œ' = ì‹­ìê°€ë¥¼ í–¥í•œ ì—¬ì •ì˜ ì‹œì‘")


if __name__ == "__main__":
    main()